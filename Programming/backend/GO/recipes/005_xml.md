#go #recipes #xml

–î–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —Å—á–∏—Ç—ã–≤–∞–µ—Ç `JSON`, –≤–Ω–æ—Å–∏—Ç –≤ –Ω–µ–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –µ–µ –≤ —Ñ–æ—Ä–º–∞—Ç `XML` –∏ –≤—ã–≤–æ–¥–∏—Ç –Ω–∞ —ç–∫—Ä–∞–Ω. –ó–∞—Ç–µ–º –¥–∞–Ω–Ω—ã–µ `XML` –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç `JSON`.

```go
package main

import (
	"encoding/json"
	"encoding/xml"
	"fmt"
	"os"
)

type Record struct {
	Name string
	Surname string
	Tel []Telephone
}

type Telephone struct {
	Mobile bool
	Number string
}

func loadFromJSON(filename string, key interface{}) error {
	in, err := os.Open(filename)
	if err != nil {
		return err
	}
	decodeJSON := json.NewDecoder(in)
	err = decodeJSON.Decode(key)
	if err != nil {
		return err
	}
	in.Close()
	return nil
}

func main() {
	arguments := os.Args
	if len(arguments) == 1 {
		fmt.Println("Please provide a filename!")
		return
	}
	filename := arguments[1]

	var myRecord Record
	err := loadFromJSON(filename, &myRecord)
	if err == nil {
		fmt.Println("JSON:", myRecord)
	} else {
		fmt.Println(err)
	}

	myRecord.Name = "Dimitris"
	// MarshalIndent - –∑–∞–¥–∞–µ—Ç –æ—Ç—Å—É—Ç–ø—ã –¥–ª—è xml
	xmlData, _ := xml.MarshalIndent(myRecord, "", "  ")
	xmlData = []byte(xml.Header + string(xmlData))
	fmt.Println("\nxmlData:", string(xmlData))

	data := &Record{}
	err = xml.Unmarshal(xmlData, data)
	if nil != err {
		fmt.Println("Unmarshalling from XML", err)
		return
	}
	result, err := json.Marshal(data)
	if nil != err {
		fmt.Println("Error marshalling to JSON", err)
		return
	}

	_ = json.Unmarshal([]byte(result), &myRecord)
	fmt.Println("\nJSON:", myRecord)
}
```
---
#### üîπ –ß—Ç–µ–Ω–∏–µ Xml-—Ñ–∞–π–ª–∞

```go
package main

import (
	"encoding/json"
	"encoding/xml"
	"fmt"
	"os"
)

type Record struct {
	Name string
	Surname string
	Tel []Telephone
}

type Telephone struct {
	Mobile bool
	Number string
}

func loadFromXML(filename string, key interface{}) error {
	in, err := os.Open(filename)
	if err != nil {
		return err
	}

	decodeXML := xml.NewDecoder(in)
	err = decodeXML.Decode(key)
	if err != nil {
		return err
	}
	in.Close()
	return nil
}	

func main() {
	arguments := os.Args
	if len(arguments) == 1 {
		fmt.Println("Please provide a filename!")
		return
	}
	filename := arguments[1]

	var myRecord Record
	err := loadFromXML(filename, &myRecord)
	if err == nil {
		fmt.Println("XML:", myRecord)
	} else {
		fmt.Println(err)
	}
}
```

==data.xml==
```xml
<?xml version="1.0" encoding="UTF-8"?>
<Record>
    <Name>Dimitris</Name>
    <Surname>Tsoukalos</Surname>
    <Tel>
        <Mobile>true</Mobile>
        <Number>1234-567</Number>
    </Tel>
    <Tel>
        <Mobile>true</Mobile>
        <Number>1234-abcd</Number>
    </Tel>
    <Tel>
        <Mobile>false</Mobile>
        <Number>abcc-567</Number>
    </Tel>
</Record>
```

```bash
# –∑–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç
go run main.go data.xml
```
---
#### üîπ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—ã–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ XML

```go
func main()  {

	type Address struct {
		City, Country string
	}

	// ",comment" —è–≤–ª—è–µ—Ç—Å—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–≤–æ–¥–µ
	// –¥–∞–Ω–Ω—ã—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º.
	// ",attr" –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–∞ –≤—ã—Ö–æ–¥–µ
	// –∫–∞–∫ –∞—Ç—Ä–∏–±—É—Ç –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –∏–º–µ–Ω–∏ –ø–æ–ª—è
	// "name>first" —É–∫–∞–∑—ã–≤–∞–µ—Ç —á—Ç–æ –Ω—É–∂–Ω–æ –≤—Å—Ç—Ä–æ–∏—Ç—å —Ç–µ–≥ first –≤ —Ç–µ–≥ name
	// "omitempty" –ø—Ä–∏ –≤—ã–≤–æ–¥–µ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –æ–Ω–æ –ø—É—Å—Ç–æ–µ
	type Employee struct {
		XMLName   xml.Name `xml:"employee"`
		Id        int      `xml:"id,attr"`
		FirstName string   `xml:"name>first"`
		LastName  string   `xml:"name>last"`
		Initials  string   `xml:"name>initials"`
		Height    float32  `xml:"height,omitempty"`
		Address
		Comment    string  `xml:",comment"`
	}

	r := &Employee{Id: 7, FirstName: "Mihalis", LastName: "Tsoukalos",
		Initials: "MIT"}
	r.Comment = "Technical Writer + DevOps"
	r.Address = Address{"SomeWhere 12", "12312, Greece"}

	output, err := xml.MarshalIndent(r, " ", " ")
	if err != nil {
		fmt.Println("Error:", err)
	}
	output = []byte(xml.Header + string(output))
	os.Stdout.Write(output)
	os.Stdout.Write([]byte("\n"))
}
```
---


