#python #sql #database #package 

- Docs - https://www.sqlalchemy.org/

SQLAlchemy ‚Äî —ç—Ç–æ¬†==–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Python —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–º–∏ –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö (—Ç–∞–∫–∏–º–∏ –∫–∞–∫ PostgreSQL, MySQL, Oracle) –∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –æ–±—ä–µ–∫—Ç–Ω–æ-—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ (ORM)==. –û–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É—è –æ–±—ä–µ–∫—Ç—ã Python –≤–º–µ—Å—Ç–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—è SQL-–∑–∞–ø—Ä–æ—Å–æ–≤ –≤—Ä—É—á–Ω—É—é.
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Å—Ç–∏–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–¥: `core`¬†–∏¬†`ORM`.
-  **Core**¬†‚Äî —ç—Ç–æ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –ø–æ–¥—Ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º SQL-–≤—ã—Ä–∞–∂–µ–Ω–∏–π, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø—Ä–æ—Ü–µ—Å—Å–æ–º. –≠—Ç–æ—Ç —Å—Ç–∏–ª—å –ø–æ–¥—Ö–æ–¥–∏—Ç —Ç–µ–º, –∫—Ç–æ —Ö–æ—á–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–∏–±–ª–∏–∑–∏—Ç—å—Å—è –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É SQL –∏–ª–∏ –∏–º–µ–µ—Ç –æ—Å–æ–±—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
- **ORM (Object-Relational Mapping)**¬†‚Äî —ç—Ç–æ —Å—Ç–∏–ª—å, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞ Python-–∫–ª–∞—Å—Å—ã. –° ORM –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å –æ–±—ä–µ–∫—Ç–∞–º–∏, –∞ –Ω–µ —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏ SQL. –ò–º–µ–Ω–Ω–æ –Ω–∞ —ç—Ç–æ—Ç —Å—Ç–∏–ª—å –º—ã –±—É–¥–µ–º –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –±–æ–ª–µ–µ —É–¥–æ–±–µ–Ω, —É–Ω–∏–≤–µ—Ä—Å–∞–ª–µ–Ω –∏ –ø–æ–ø—É–ª—è—Ä–µ–Ω —Å—Ä–µ–¥–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.

#### üîπ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã ORM

- **–ú–æ–¥–µ–ª–∏ —Ç–∞–±–ª–∏—Ü**¬†‚Äî —ç—Ç–æ Python-–∫–ª–∞—Å—Å—ã, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–∏ –∫–ª–∞—Å—Å—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ç–∞–±–ª–∏—Ü, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∫–æ–ª–æ–Ω–∫–∏, —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏.
- **–°–µ—Å—Å–∏–∏**¬†‚Äî –æ–±—ä–µ–∫—Ç—ã, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–µ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è. –°–µ—Å—Å–∏—è –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —Å–≤—è–∑—å —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –æ–¥–Ω–æ–≥–æ ¬´—Å–µ–∞–Ω—Å–∞¬ª. –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å–µ—Å—Å–∏—é, –±–µ–∑ –Ω–µ—ë –Ω–∏–∫–∞–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã.
	–°–µ—Å—Å–∏—è —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –∏ —Å–ª–µ–¥–∏—Ç –∑–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –æ–±—ä–µ–∫—Ç–æ–≤, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –≤—ã —Ä–∞–±–æ—Ç–∞–µ—Ç–µ. –û–Ω–∞ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø—Ä—è–º–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –±–∞–∑–æ–π, –∞ –∞–±—Å—Ç—Ä–∞–≥–∏—Ä—É–µ—Ç —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å. ==–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥¬†`commit()`==. –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –∏—Ö –º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å —Å –ø–æ–º–æ—â—å—é¬†`rollback()`.
- **–§–∞–±—Ä–∏–∫–∞ —Å–µ—Å—Å–∏–π**¬†‚Äî —ç—Ç–æ —à–∞–±–ª–æ–Ω –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Å—Å–∏–π. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

##### üî∏ –§–∞–±—Ä–∏–∫–∞ —Å–µ—Å—Å–∏–π
—ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏. –í SQLAlchemy —ç—Ç–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é¬†`sessionmaker()`. –≠—Ç–æ—Ç –æ–±—ä–µ–∫—Ç —Å–æ–∑–¥–∞—ë—Ç —Å–µ—Å—Å–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –í —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –∑–∞–ø–∏—Å—å –±—É–¥–µ—Ç —Ç–∞–∫–æ–π:
```python
from sqlalchemy.orm import sessionmaker

Session = sessionmaker(bind=engine)
session = Session()
```

==–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ–∞–±—Ä–∏–∫–∞ —Å–µ—Å—Å–∏–π==

> ‚ö†Ô∏è –í–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç: —Å–µ—Å—Å–∏–∏ –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º –∫–æ–¥–µ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –ø–æ—ç—Ç–æ–º—É –¥–ª—è —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ–∞–±—Ä–∏–∫–∞ —Å–æ–∑–¥–∞—ë—Ç —Å–µ—Å—Å–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `async_sessionmaker`.
```python
DATABASE_URL = settings.get_db_url()

# –°–æ–∑–¥–∞–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–≤–∏–∂–æ–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
engine = create_async_engine(url=DATABASE_URL)

# –°–æ–∑–¥–∞–µ–º —Ñ–∞–±—Ä–∏–∫—É —Å–µ—Å—Å–∏–π –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
async_session_maker = async_sessionmaker(engine, expire_on_commit=False)
```

–î–∞–ª–µ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å —Å–µ—Å—Å–∏—é (–¥–æ—Å—Ç–∞—Ç—å –µ–µ –∏–∑ —Ñ–∞–±—Ä–∏–∫–∏ —Å–µ—Å—Å–∏–π). –ó–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –ü–æ—Å–ª–µ —á–µ–≥–æ —Å–µ—Å—Å–∏—é –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–∫—Ä—ã–≤–∞—Ç—å. –ü—Ä–æ—â–µ –≤—Å–µ–≥–æ —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä async with. –†–∞–±–æ—Ç–∞ –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏, –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ, –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –≤–∏–¥:
```python
async with AsyncSessionLocal() as session:
    # –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
```

–¢–æ –µ—Å—Ç—å, –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–± –Ω–∞—á–∞—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç—É–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏) –Ω–∞–º –≤—Å–µ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –±—ã—Ç—å –≤ —Ä–∞–º–∫–∞—Ö —Å–µ—Å—Å–∏–∏. –í–æ–ø—Ä–æ—Å —Ç–æ–ª—å–∫–æ –≤ —Ç–æ–º –∫–∞–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π –≤—ã –±—É–¥–µ—Ç–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–π —Ç–∞–∫–æ–π —Å–µ—Å—Å–∏–∏, –¥–æ –µ–µ –∑–∞–∫—Ä—ã—Ç–∏—è.

==–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é —Å–µ—Å—Å–∏—è–º–∏==
- –û—Ç–∫—Ä—ã—Ç–∏–µ —Å–µ—Å—Å–∏–∏ –Ω–∞ –∫–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ: –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤–∞—è —Å–µ—Å—Å–∏—è. –≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤, –Ω–æ –Ω–∞ –∫—Ä—É–ø–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö –æ–Ω –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –Ω–∞–∫–ª–∞–¥–Ω—ã–º —Ä–∞—Å—Ö–æ–¥–∞–º.
- –û—Ç–∫—Ä—ã—Ç–∏–µ —Å–µ—Å—Å–∏–∏ –Ω–∞ –≤–µ—Å—å –±–ª–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π: —Å–µ—Å—Å–∏—è —Å–æ–∑–¥–∞—ë—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø–µ—Ä–µ–¥ —Å–µ—Ä–∏–µ–π –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –æ–¥–Ω—É —Å–µ—Å—Å–∏—é, —á—Ç–æ —ç–∫–æ–Ω–æ–º–∏—Ç —Ä–µ—Å—É—Ä—Å—ã –∏ –ø–æ–≤—ã—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

##### üî∏ –î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏
–¥–∞–Ω–Ω—ã–π –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª `database.py`
```python
def connection(method):
    async def wrapper(*args, **kwargs):
        async with async_session_maker() as session:
            try:
                # –Ø–≤–Ω–æ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ —É–∂–µ –µ—Å—Ç—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
                return await method(*args, session=session, **kwargs)
            except Exception as e:
                await session.rollback()  # –û—Ç–∫–∞—Ç—ã–≤–∞–µ–º —Å–µ—Å—Å–∏—é –ø—Ä–∏ –æ—à–∏–±–∫–µ
                raise e  # –ü–æ–¥–Ω–∏–º–∞–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–∞–ª—å—à–µ
            finally:
                await session.close()  # –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–µ—Å—Å–∏—é

    return wrapper
```

==–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —ç—Ç–æ—Ç –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä==
- `connection`¬†–ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ–±—ë—Ä—Ç–∫–∏.
-  `wrapper`¬†‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è-–æ–±—ë—Ä—Ç–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Å–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∏—Å—Ö–æ–¥–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.
-  `async with async_session_maker()`¬†–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–µ—Å—Å–∏—é –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ, –æ—Å–≤–æ–±–æ–∂–¥–∞—è –≤–∞—Å –æ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–µ—Å—Å–∏–µ–π –≤—Ä—É—á–Ω—É—é.
- –°–µ—Å—Å–∏—è –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –∏—Å—Ö–æ–¥–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é —á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç¬†`session`.
- –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç–∫–∞—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —á–µ—Ä–µ–∑¬†`rollback()`, –∞ –∑–∞—Ç–µ–º —Å–µ—Å—Å–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è.

==–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è== (–ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `get_users()`, –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞—ë—Ç —Å–µ—Å—Å–∏—é, –ø–µ—Ä–µ–¥–∞—ë—Ç –µ—ë –≤ —Ñ—É–Ω–∫—Ü–∏—é, –∞ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–µ—Å—Å–∏—é, —á—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç –∏ –æ–±–µ–∑–æ–ø–∞—Å–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö)
```python
@connection
async def get_users(session):
    return await session.execute(select(User))
```
#### üîπ –ü—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–¥

==database.py==
```python
from sqlalchemy.orm import DeclarativeBase
from sqlalchemy.ext.asyncio import AsyncAttrs, async_sessionmaker, create_async_engine
from config import settings


DATABASE_URL = settings.get_db_url()

# –°–æ–∑–¥–∞–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–≤–∏–∂–æ–∫ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
engine = create_async_engine(url=DATABASE_URL)
# –°–æ–∑–¥–∞–µ–º —Ñ–∞–±—Ä–∏–∫—É —Å–µ—Å—Å–∏–π –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
async_session_maker = async_sessionmaker(engine, expire_on_commit=False)


# –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
class Base(AsyncAttrs, DeclarativeBase):
    __abstract__ = True  # –ö–ª–∞—Å—Å –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π, —á—Ç–æ–±—ã –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –Ω–µ–≥–æ
```

==**–û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**==
- `DeclarativeBase`: –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –±—É–¥—É—Ç –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å—Å—è –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã (–º–æ–¥–µ–ª–∏ —Ç–∞–±–ª–∏—Ü). –≠—Ç—É –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∞ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ.
-  `AsyncAttrs`: –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏, —á—Ç–æ —É–ª—É—á—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏.
- `create_async_engine`: –§—É–Ω–∫—Ü–∏—è, —Å–æ–∑–¥–∞—é—â–∞—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–≤–∏–∂–æ–∫ –¥–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –ø–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º—É URL.
- `async_sessionmaker`: –§–∞–±—Ä–∏–∫–∞ —Å–µ—Å—Å–∏–π –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –°–µ—Å—Å–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

==**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç**==
- `DATABASE_URL`: –§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —Å¬†–ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `get_db_url` –∏–∑¬†—Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ `config.py`. –°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å—é –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è¬†–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫¬†–±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
- `engine`: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–≤–∏–∂–æ–∫, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è¬†–≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å¬†–±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.
- `async_session_maker`: –§–∞–±—Ä–∏–∫–∞ —Å–µ—Å—Å–∏–π, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–µ—Å—Å–∏–∏ –¥–ª—è¬†–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å¬†–±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö, —É–ø—Ä–∞–≤–ª—è—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã.
- `Base`: –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è¬†–≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π, –æ—Ç¬†–∫–æ—Ç–æ—Ä–æ–≥–æ –±—É–¥—É—Ç –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å—Å—è –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã. –û–Ω –Ω–µ¬†—Å–æ–∑–¥–∞—Å—Ç –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –≤¬†–±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –Ω–æ¬†–ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç –±–∞–∑–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è¬†–≤—Å–µ—Ö –¥—Ä—É–≥–∏—Ö –º–æ–¥–µ–ª–µ–π.

–í –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –º–æ–∂–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç—Ä–µ—Ö —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–π —Ç–∞–±–ª–∏—Ü—ã.
–ú—ã –æ–ø–∏—à–µ–º —ç—Ç–∏ –∫–æ–ª–æ–Ω–∫–∏ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑, –∞ —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –æ–Ω–∏ –±—É–¥—É—Ç –≤ –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü–µ. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –¥–∞–≤–∞–π—Ç–µ —Å–æ–∑–¥–∞–¥–∏–º —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –¥–∞–≤–∞—Ç—å –∏–º–µ–Ω–∞ –Ω–∞—à–∏–º —Ç–∞–±–ª–∏—Ü–∞–º –ø–æ —Ç–∞–∫–æ–π —Å—Ö–µ–º–µ: ¬´–∏–º—è –º–æ–¥–µ–ª–∏ —Ç–∞–±–ª–∏—Ü—ã¬ª + ¬´s¬ª —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º –≤ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä.
–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —É –Ω–∞—Å –±—ã–ª–æ –∏–º—è –º–æ–¥–µ–ª–∏¬†`User`, —Ç–æ –∏–º—è —Ç–∞–±–ª–∏—Ü—ã –±—É–¥–µ—Ç¬†`users`.
```python
# –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
class Base(AsyncAttrs, DeclarativeBase):
    __abstract__ = True  # –ö–ª–∞—Å—Å –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π, —á—Ç–æ–±—ã –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –Ω–µ–≥–æ
	
	# –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è
    id: Mapped[int] = mapped_column(Integer, primary_key=True, autoincrement=True)
    # –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏, –∑–∞–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    created_at: Mapped[datetime] = mapped_column(server_default=func.now())
    # –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏
    updated_at: Mapped[datetime] = mapped_column(server_default=func.now(), onupdate=func.now())

    @declared_attr.directive
    def __tablename__(cls) -> str:
        return cls.__name__.lower() + 's'
```

##### üî∏ `Mapped`
–≠—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–æ–ª–æ–Ω–æ–∫ –≤ –º–æ–¥–µ–ª—è—Ö SQLAlchemy. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–æ–ª–µ–µ —á–µ—Ç–∫–æ —É–∫–∞–∑–∞—Ç—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–ª–æ–Ω–∫—É —Ç–∞–±–ª–∏—Ü—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
```python
id: Mapped[int] = mapped_column(Integer, primary_key=True, autoincrement=True)
```

–µ—Å–ª–∏ –Ω—É–∂–Ω–æ —á—Ç–æ-—Ç–æ ¬´—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ¬ª, –∏—Å–ø–æ–ª—å–∑—É–µ–º —á–∏—Å—Ç—ã–π¬†`Mapped`, –∞ –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ ‚Äî –¥–æ–±–∞–≤–ª—è–µ–º¬†`mapped_column`

```python
name: Mapped[str]
surname: Mapped[str | None]
```

##### üî∏ `mapped_column`
—ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ –≤ –º–æ–¥–µ–ª—è—Ö SQLAlchemy. –û–Ω–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –∫–æ–ª–æ–Ω–∫–∏ –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Ç–∞–∫–∏–µ –∫–∞–∫¬†`primary_key`,¬†`nullable`,¬†`default`¬†–∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.

#### üîπ –ú–æ–¥–µ–ª–∏
–ú–æ–¥–µ–ª–∏ —Ç–∞–±–ª–∏—Ü –≤ SQLAlchemy ‚Äî —ç—Ç–æ —Å–≤–æ–µ–æ–±—Ä–∞–∑–Ω—ã–µ Python-–∫–ª–∞—Å—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–ø—Ä—è–º—É—é –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ö–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å –æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É, –µ—ë –∫–æ–ª–æ–Ω–∫–∏ –∏ –∏—Ö —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö. –ú–æ–¥–µ–ª–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –≤–∞–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∑–∞–ø–∏—Å—è–º–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∫–∞–∫ —Å –æ–±—ã—á–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏.

==models.py==
```python
from sqlalchemy import ForeignKey
from sqlalchemy.orm import Mapped, mapped_column
from database import Base

class User(Base):
    username: Mapped[str] = mapped_column(unique=True)
    email: Mapped[str] = mapped_column(unique=True)
    password: Mapped[str]
    profile_id: Mapped[int | None] = mapped_column(ForeignKey('profiles.id'))
```

##### üî∏ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞ —Å –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏
–í –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ –µ—Å—Ç—å —Å—Ç—Ä–æ–∫–∞ –∫–æ—Ç–æ—Ä–∞—è –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è - `Mapped[str] = mapped_column(unique=True)`. –ß—Ç–æ–±—ã –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å, –º—ã –º–æ–∂–µ–º –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏.
–ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –≤ SQLAlchemy –ø–æ–∑–≤–æ–ª—è—é—Ç –≤—ã–Ω–µ—Å—Ç–∏ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –º—ã –º–æ–∂–µ–º –æ–ø–∏—Å—ã–≤–∞—Ç—å –∫–æ–ª–æ–Ω–∫–∏ –æ–¥–∏–Ω —Ä–∞–∑, –∞ –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –≤ –º–æ–¥–µ–ª—è—Ö.

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–∑ –º–æ–¥—É–ª—è¬†`typing`¬†–∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç¬†`Annotated`. –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —è –æ–±—ã—á–Ω–æ –æ–ø–∏—Å—ã–≤–∞—é –≤ —Ñ–∞–π–ª–µ¬†`database.py`. –í–æ—Ç –ø—Ä–∏–º–µ—Ä:
```python
from typing import Annotated
from sqlalchemy import String
from sqlalchemy.orm import mapped_column


uniq_str_an = Annotated[str, mapped_column(unique=True)]
```

==–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏==
```python
from sqlalchemy import ForeignKey
from sqlalchemy.orm import Mapped, mapped_column
from database import Base, uniq_str_an


class User(Base):
    username: Mapped[uniq_str_an]
    email: Mapped[uniq_str_an]
    password: Mapped[str]
    profile_id: Mapped[int | None] = mapped_column(ForeignKey('profiles.id'))
```

##### üî∏ –¢–∏–ø –ø–æ–ª–µ–π `enum`, `array`, `json`

–û–ø–∏—Å—ã–≤–∞–µ–º –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –º–æ–¥–µ–ª–∏ ==Profile==
```python
import enum

class GenderEnum(str, enum.Enum):
    MALE = "–º—É–∂—á–∏–Ω–∞"
    FEMALE = "–∂–µ–Ω—â–∏–Ω–∞"

class ProfessionEnum(str, enum.Enum):
    DEVELOPER = "—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫"
    DESIGNER = "–¥–∏–∑–∞–π–Ω–µ—Ä"
    MANAGER = "–º–µ–Ω–µ–¥–∂–µ—Ä"
    UNEMPLOYED = "–±–µ–∑—Ä–∞–±–æ—Ç–Ω—ã–π"

class Profile(Base):
    first_name: Mapped[str]
    last_name: Mapped[str | None]
    age: Mapped[int | None]
    gender: Mapped[GenderEnum]
    profession: Mapped[ProfessionEnum] = mapped_column(
        default=ProfessionEnum.DEVELOPER,
        server_default=text("'UNEMPLOYED'")
    )
    # —Å–ø–∏—Å–æ–∫ (Array) –∏–∑¬†—Å—Ç—Ä–æ–∫
    interests: Mapped[List[str] | None] = mapped_column(ARRAY(String))
    # JSON (–ø–∏—Ç–æ–Ω–æ–≤—Å–∫–∏–π —Å–ª–æ–≤—Ä—å) —Å¬†–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º —Å–ø–∏—Å–∫–æ–º –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
    contacts: Mapped[dict | None] = mapped_column(JSON)
```

==**–ü–∞—Ä–∞–º–µ—Ç—Ä**¬†`default`:==
- –≠—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –∑–∞–¥–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ —É—Ä–æ–≤–Ω–µ¬†**–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**¬†(SQLAlchemy).
- –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –µ—Å–ª–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞ –≤ –∫–æ–¥–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—è –Ω–µ —É–∫–∞–∑–∞–Ω–æ, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ, —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤¬†`default`. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞ –∫–ª–∞—Å—Å–∞¬†`User`, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—è¬†`profession`¬†–Ω–µ –ø–µ—Ä–µ–¥–∞–Ω–æ, SQLAlchemy –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤¬†`default`.

==**–ü–∞—Ä–∞–º–µ—Ç—Ä**¬†`server_default`:==
- –≠—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –∑–∞–¥–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ —É—Ä–æ–≤–Ω–µ¬†**–±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**.
- –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –µ—Å–ª–∏ –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –∑–∞–ø–∏—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü—É –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—è –Ω–µ —É–∫–∞–∑–∞–Ω–æ, —Å–∞–º–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥—Å—Ç–∞–≤–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤¬†`server_default`. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç¬†`default`, —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è, –µ—Å–ª–∏ –∑–∞–ø–∏—Å—å –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É –Ω–∞–ø—Ä—è–º—É—é, –Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ SQL-–∑–∞–ø—Ä–æ—Å—ã, –º–∏–Ω—É—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
- **–í–∞–∂–Ω–æ:**¬†–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ —Å ENUM, –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –≤–∏–¥–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞¬†`text`, –∫–æ—Ç–æ—Ä—ã–π –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –∏–∑ SQLAlchemy. –ó–Ω–∞—á–µ–Ω–∏–µ ENUM —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –∫–∞–≤—ã—á–∫–∞—Ö –∫–∞–∫ —Ç–µ–∫—Å—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä:¬†`"WRITER"`, –∞ –Ω–µ —Å–∞–º–æ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–∞–∫–æ–µ –∫–∞–∫¬†`ProfessionEnum.WRITER`. –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

##### üî∏ –¢–∏–ø –ø–æ–ª—è `datetime`

```python
created_at: Mapped[datetime] = mapped_column(
	DateTime,
	server_default=func.now()
)  
updated_at: Mapped[datetime] = mapped_column(
	DateTime,
	server_default=func.now(),
	onupdate=func.now()
)  
deleted_at: Mapped[datetime | None] = mapped_column(DateTime, nullable=True)
```

##### üî∏ –¢–∏–ø –ø–æ–ª—è `bool`
```python
is_available: Mapped[bool] = mapped_column(Boolean, default=True)
```

##### üî∏ –¢–∏–ø –ø–æ–ª—è `bytes`
```python
password: Mapped[bytes] = mapped_column(LargeBinary, nullable=False)
```
---
#### üîπ Relationship

–í SQLAlchemy —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è¬†`relationship`¬†–ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤—è–∑—è–º–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏.
##### üî∏ –û–¥–∏–Ω-–∫-–æ–¥–Ω–æ–º—É (One-to-One)
–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏¬†`User`¬†–∏¬†`Profile`

==–°–≤—è–∑—å –≤ –º–æ–¥–µ–ª–∏ User:==
```python
profile: Mapped["Profile"] = relationship(
    "Profile",
    back_populates="user",
    uselist=False,  # –ö–ª—é—á–µ–≤–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è —Å–≤—è–∑–∏ –æ–¥–∏–Ω-–∫-–æ–¥–Ω–æ–º—É
    lazy="joined"  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç profile –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ user
)
```

- `back_populates="user"`¬†‚Äî —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∞—Ç—Ä–∏–±—É—Ç –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –≤ –º–æ–¥–µ–ª–∏¬†`Profile`. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ –ø—Ä–æ—Ñ–∏–ª—é –º–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –ø–æ–ª—É—á–∏—Ç—å —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- `uselist=False`¬†‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ —Å–≤—è–∑—å –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å–ø–∏—Å–∫–æ–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é¬†`relationship`¬†–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç —Å–≤—è–∑—å "–æ–¥–∏–Ω-–∫–æ-–º–Ω–æ–≥–∏–º" –∏–ª–∏ "–º–Ω–æ–≥–∏–µ-–∫-–æ–¥–Ω–æ–º—É"). –ó–¥–µ—Å—å –æ–¥–∏–Ω –ø—Ä–æ—Ñ–∏–ª—å –Ω–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–æ—ç—Ç–æ–º—É¬†`uselist=False`¬†–∑–∞–¥–∞–µ—Ç —Å–≤—è–∑—å –æ–¥–∏–Ω-–∫-–æ–¥–Ω–æ–º—É.
- `lazy="joined"`¬†‚Äî –∑–∞–¥–∞–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –ø–æ–¥–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö. SQLAlchemy –≤—ã–ø–æ–ª–Ω–∏—Ç¬†`JOIN`¬†–∑–∞–ø—Ä–æ—Å –∏ –ø–æ–¥–≥—Ä—É–∑–∏—Ç –ø—Ä–æ—Ñ–∏–ª—å —Å—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

==–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –≤ –º–æ–¥–µ–ª–∏ Profile:==
```python
user: Mapped["User"] = relationship(
    "User",
    back_populates="profile",
    uselist=False
)
```

##### üî∏ –°–≤—è–∑—å –û–¥–∏–Ω-–∫–æ-–ú–Ω–æ–≥–∏–º –∏ –ú–Ω–æ–≥–∏–µ-–∫-–û–¥–Ω–æ–º—É
–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏¬†`User`¬†–∏¬†`Post`

```python
class User(Base):
    # –ü–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...
    
    posts: Mapped[list["Post"]] = relationship(
        "Post",
        back_populates="user",
        cascade="all, delete-orphan"  # –£–¥–∞–ª—è–µ—Ç –ø–æ—Å—Ç—ã –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    )

class Post(Base):
    # –ü–æ–ª—è –ø–æ—Å—Ç–∞...
    
    user_id: Mapped[int] = mapped_column(ForeignKey('users.id'))
    
    user: Mapped["User"] = relationship(
        "User",
        back_populates="posts"
    )
```

##### üî∏ –°–≤—è–∑—å –ú–Ω–æ–≥–∏–µ-–∫–æ-–ú–Ω–æ–≥–∏–º 
–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏¬†`Role`¬†–∏¬†`Permission`.
–î–ª—è —Å–≤—è–∑–∏ –¥–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Å–≤—è–∑—è—Ö.

```python
from sqlalchemy import String, Text, ForeignKey, Boolean  
from sqlalchemy.orm import Mapped, mapped_column, relationship  
  
from src.database import Base  
  
class Role(Base):  
	...  
    permissions: Mapped[list["Permission"]] = relationship(  
        secondary="rbac_role_permission",  
        back_populates="roles",  
    )  
  
class Permission(Base):  
	...  
    roles: Mapped[list["Role"]] = relationship(  
        secondary="rbac_role_permission",  
        back_populates="permissions",  
    )  
  
class RolePermission(Base):  
    __tablename__ = "rbac_role_permission"  
  
    role_id: Mapped[int] = mapped_column(  
        ForeignKey("rbac_roles.id"),  
        primary_key=True,  
        # ondelete="CASCADE",  
    )  
    permission_id: Mapped[int] = mapped_column(  
        ForeignKey("rbac_permissions.id"),  
        primary_key=True,  
        # ondelete="CASCADE",  
    )  
  
    # role = relationship("Role", back_populates="permissions")  
    # permission = relationship("Permission", back_populates="roles")
```
---
#### üîπ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü—ã

–ü—Ä–æ—Ü–µ—Å—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ SQLAlchemy –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤:
-  **–û—Ç–∫—Ä—ã—Ç–∏–µ —Å–µ—Å—Å–∏–∏**¬†‚Äî —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —à–∞–≥ –¥–ª—è¬†–≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å¬†–±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö. –ú—ã —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ –µ–≥–æ —á–µ—Ä–µ–∑ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–µ—Å—Å–∏—é.
- **–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Å—Ç–∞–Ω—Å–∞ (—ç–∫–∑–µ–º–ø–ª—è—Ä–∞)**¬†‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å —Å—Ç—Ä–æ–∫—É –≤¬†—Ç–∞–±–ª–∏—Ü–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –ú—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –µ–≥–æ, –ø–µ—Ä–µ–¥–∞–≤–∞—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª–µ–π —Ç–∞–±–ª–∏—Ü—ã.
- **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞**¬†‚Äî SQLAlchemy –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏—è —Å¬†–æ–±—ä–µ–∫—Ç–æ–º –º–æ–¥–µ–ª–∏ –≤¬†SQL‚Äë–∑–∞–ø—Ä–æ—Å. –≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å —Å–æ–æ–±—â–∏—Ç –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –∫–∞–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å.
- **–ö–æ–º–º–∏—Ç (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π)**¬†‚Äî –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫¬†–æ–±—ä–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –∏ —Å–µ—Å—Å–∏—è –∑–Ω–∞–µ—Ç, —á—Ç–æ¬†–µ–≥–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å, –º—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –¥–µ–π—Å—Ç–≤–∏–µ —Å¬†–ø–æ–º–æ—â—å—é commit(), —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å –≤¬†–±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

==–ø—Ä–æ—Å—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ==
```python
@connection
async def add_user(name: str, age: int, session):
    # –°–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç User (–∏–Ω—Å—Ç–∞–Ω—Å –º–æ–¥–µ–ª–∏)
    new_user = User(name=name, age=age)
    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—ä–µ–∫—Ç –≤ —Å–µ—Å—Å–∏—é
    session.add(new_user)
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    await session.commit()
```

##### üî∏ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Å–≤—è–∑–∞–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É (One-to-One)

==–≤–∞—Ä–∏–∞–Ω—Ç 1==
```python
user = User(username=username, email=email, password=password)
session.add(user)
await session.commit()

profile = Profile(
    user_id=user.id,
    first_name=first_name,
    last_name=last_name,
)

session.add(profile)
await session.commit()
```

==–≤–∞—Ä–∏–∞–Ω—Ç 2 (–±–æ–ª–µ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π, –∏—Å–ø–æ–ª—å–∑—É—è flush())==
```python
user = User(username=username, email=email, password=password)
session.add(user)
await session.flush()  # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —à–∞–≥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è user.id –±–µ–∑ –∫–æ–º–º–∏—Ç–∞

profile = Profile(
    user_id=user.id,
    first_name=first_name,
    last_name=last_name,
)
session.add(profile)

# –û–¥–∏–Ω –∫–æ–º–º–∏—Ç –¥–ª—è –æ–±–æ–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π
await session.commit()
```

##### üî∏ `flush()`
`flush`¬†–≤ SQLAlchemy –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –∏—Ö –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–π —Ñ–∏–∫—Å–∞—Ü–∏–∏, —Ç–æ –µ—Å—Ç—å –±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–º–∏—Ç–∞. –≠—Ç–æ –ø–æ–ª–µ–∑–Ω–æ, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, —Ç–∞–∫–∏–µ –∫–∞–∫ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, user.id), —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –¥–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –±–∞–∑–µ. –ü—Ä–∏ —ç—Ç–æ–º —Å–∞–º–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Å—Ç–∞—ë—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç–æ–π, –∏ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–∑–∂–µ, –ø—Ä–∏ –≤—ã–∑–æ–≤–µ commit.

==–ü–æ—á–µ–º—É —ç—Ç–æ –±–æ–ª–µ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ:==
- **–†–∞–±–æ—Ç–∞ —Å¬†–ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏**: flush –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å¬†–¥–∞–Ω–Ω—ã–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –µ—â—ë –Ω–µ¬†–∑–∞–ø–∏—Å–∞–Ω—ã –≤¬†–±–∞–∑—É –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ¬†—É–∂–µ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è¬†–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –µ–≥–æ user.id –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –¥–ª—è¬†–¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è, –Ω–µ¬†–≤—ã–ø–æ–ª–Ω—è—è –∫–æ–º–º–∏—Ç –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏.
- **–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π**: –ò—Å–ø–æ–ª—å–∑—É—è flush, –º—ã –∏–∑–±–µ–≥–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–æ–º–º–∏—Ç–æ–≤. –≠—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞¬†–±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫ –∫–∞–∫¬†–≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –æ–¥–Ω–∏–º –∫–æ–º–º–∏—Ç–æ–º –≤¬†–∫–æ–Ω—Ü–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑, —á—Ç–æ¬†—É—Å–∫–æ—Ä—è–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π.

##### üî∏ –ú–∞—Å—Å–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü—É
–î–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ SQLAlchemy —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —É–¥–æ–±–Ω—ã–π –º–µ—Ç–æ–¥ `add_all`. –û–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –º–µ—Ç–æ–¥—É add, –Ω–æ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ —Å–ø–∏—Å–æ–∫ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ (–∏–Ω—Å—Ç–∞–Ω—Å–æ–≤). –° –µ–≥–æ –ø–æ–º–æ—â—å—é –º—ã –º–æ–∂–µ–º –¥–æ–±–∞–≤–∏—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –∑–∞ –æ–¥–Ω—É –æ–ø–µ—Ä–∞—Ü–∏—é

```python
@connection
async def create_user_example_4(users_data: list[dict], session: AsyncSession) -> list[int]:
    """
    –°–æ–∑–¥–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º ORM SQLAlchemy.

    –ê—Ä–≥—É–º–µ–Ω—Ç—ã:
    - users_data: list[dict] - —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
      –ö–∞–∂–¥—ã–π —Å–ª–æ–≤–∞—Ä—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–ª—é—á–∏: 'username', 'email', 'password'.
    - session: AsyncSession - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Å–µ—Å—Å–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
    - list[int] - —Å–ø–∏—Å–æ–∫ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    """
    users_list = [
        User(
            username=user_data['username'],
            email=user_data['email'],
            password=user_data['password']
        )
        for user_data in users_data
    ]
    session.add_all(users_list)
    await session.commit()
    return [user.id for user in users_list]
```
---
#### üîπ –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
–î–ª—è –≤—ã–±–æ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ SQLAlchemy –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ—Ç–æ–¥ `select()`, –∫–æ—Ç–æ—Ä—ã–π —Å–ª—É–∂–∏—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–æ—á–∫–æ–π –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö

==–ø—Ä–∏–º–µ—Ä –ø—Ä–æ—Å—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞==
```python
@classmethod
async def get_all_users(cls, session: AsyncSession):
    # –°–æ–∑–¥–∞–µ–º –∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    query = select(cls.model)

    # –í—ã–ø–æ–ª–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å –∏ –ø–æ–ª—É—á–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    result = await session.execute(query)

    # –ò–∑–≤–ª–µ–∫–∞–µ–º –∑–∞–ø–∏—Å–∏ –∫–∞–∫ –æ–±—ä–µ–∫—Ç—ã –º–æ–¥–µ–ª–∏
    records = result.scalars().all()

    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    return records
```
–≤ –¥–∞–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ —Å—Ç—Ä–æ–∫–∞ - `select(cls.model)` - , –±—É–¥–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω –≤ SQL-–∑–∞–ø—Ä–æ—Å –≤–∏–¥–∞:¬†`SELECT * FROM users;`

##### üî∏ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞
–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –∑–∞–ø—Ä–æ—Å –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `session.execute(query)`, SQLAlchemy –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç¬†**result**. –≠—Ç–æ—Ç –æ–±—ä–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä–æ–∫–∏, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –Ω–æ —á—Ç–æ–±—ã –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –∏—Ö –≤ –æ–±—ä–µ–∫—Ç—ã –º–æ–¥–µ–ª–µ–π –∏–ª–∏ –Ω—É–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç, –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã: `scalars()`, `all()`, `first()`, –∏ –¥—Ä—É–≥–∏–µ

- ==scalars()==
–ú–µ—Ç–æ–¥ `scalars()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –º—ã –æ–∂–∏–¥–∞–µ–º –ø–æ–ª—É—á–∏—Ç—å¬†**–æ–¥–Ω—É –∫–æ–ª–æ–Ω–∫—É**¬†—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞, –∞ –Ω–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–ª–µ–π. –ù–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–≥–¥–∞ –º—ã –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –≤—Å—é –º–æ–¥–µ–ª—å (–∫–∞–∫ –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ) –∏–ª–∏ –æ–¥–Ω–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø–æ–ª–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–ª—å–∫–æ –∏–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π).
```python
result = await session.execute(query)
records = result.scalars().all()
```
–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ `scalars()` –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –æ–±—ä–µ–∫—Ç—ã –º–æ–¥–µ–ª–∏, —Ç–∞–∫ –∫–∞–∫ –º—ã –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –≤—Å—é –º–æ–¥–µ–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `User`). –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–ª–æ–Ω–æ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `id`, `name`, `email`), —Ç–æ `scalars()` "–≤—ã–±–µ—Ä–µ—Ç" —Ç–æ–ª—å–∫–æ —Ç—É –∫–æ–ª–æ–Ω–∫—É, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏ (–∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—é, –µ—Å–ª–∏ –æ–Ω–æ –±—ã–ª–æ –∑–∞–ø—Ä–æ—à–µ–Ω–æ)

- ==all()==
–ú–µ—Ç–æ–¥ `all()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç¬†**—Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö**¬†–∑–∞–ø–∏—Å–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—Ç –Ω–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É. –ö–æ–≥–¥–∞ –º—ã –ø—Ä–∏–º–µ–Ω—è–µ–º –µ–≥–æ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º `scalars()`, –º—ã –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –≤—ã–±—Ä–∞–Ω—ã.

¬†- ==first()==
¬†–ú–µ—Ç–æ–¥ `first()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç¬†**—Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—É—é –∑–∞–ø–∏—Å—å**¬†–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–∞
¬†```python
¬†record = result.scalars().first()
¬†```

- ==scalar()==
–ú–µ—Ç–æ–¥ `scalar()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –º—ã –æ–∂–∏–¥–∞–µ–º¬†**–æ–¥–Ω—É –∑–∞–ø–∏—Å—å –∏ –æ–¥–Ω–æ –ø–æ–ª–µ**¬†–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∑–∞–ø—Ä–æ—Å–∞. –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω–µ—Ç –±–æ–ª—å—à–µ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, –º–µ—Ç–æ–¥ –≤—ã–±—Ä–æ—Å–∏—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ.
```python
record = result.scalar()
```

- ==scalar_one() –∏ scalar_one_or_none()==
–≠—Ç–∏ –º–µ—Ç–æ–¥—ã –ø–æ—Ö–æ–∂–∏ –Ω–∞ `scalar()`, –Ω–æ —Å –≤–∞–∂–Ω—ã–º–∏ –æ—Ç–ª–∏—á–∏—è–º–∏:
- `scalar_one()`¬†‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ. –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω–µ—Ç –±–æ–ª–µ–µ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –æ—à–∏–±–∫–∞.
- `scalar_one_or_none()`¬†‚Äî –≤–µ—Ä–Ω–µ—Ç¬†–ª–∏–±–æ –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ,¬†–ª–∏–±–æ `None`, –µ—Å–ª–∏ –∑–∞–ø–∏—Å–µ–π –Ω–µ¬†–Ω–∞–π–¥–µ–Ω–æ. –ï—Å–ª–∏ –≤–µ—Ä–Ω–µ—Ç—Å—è –±–æ–ª–µ–µ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, —Ç–∞–∫–∂–µ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –æ—à–∏–±–∫–∞.

##### üî∏ –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø–æ–ª–µ–π
```python
    # –°–æ–∑–¥–∞–µ–º –∑–∞–ø—Ä–æ—Å –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ id –∏ username –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    query = select(cls.model.id, cls.model.username)  # –£–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏
    print(query)  # –í—ã–≤–æ–¥–∏–º –∑–∞–ø—Ä–æ—Å –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
    result = await session.execute(query)  # –í—ã–ø–æ–ª–Ω—è–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å
    records = result.all()  # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    return records  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π
```