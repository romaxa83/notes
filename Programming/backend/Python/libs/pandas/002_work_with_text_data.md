#python #package #pandas #recipes

–û–¥–Ω–∞ –∏–∑ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∏–¥–µ–π pandas —Å–æ—Å—Ç–æ–∏—Ç –≤ —É–ø—Ä–æ—â–µ–Ω–∏–∏ –æ—á–∏—Å—Ç–∫–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ—Ä–µ–¥–∫–æ –æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Å–∏–ª—å–Ω–æ –∑–∞—à—É–º–ª–µ–Ω–Ω—ã–º–∏.

(http://mng.bz/9N60
#### üîπ –†–µ–≥–∏—Å—Ç—Ä –±—É–∫–≤ –∏ –ø—Ä–æ–±–µ–ª—ã

```python
inspections = pd.read_csv("chicago_food_inspections.csv")
# –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –µ—Å—Ç—å –ª–∏ —É –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–æ–±–µ–ª—ã —Å–Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞
inspections["Name"].head().values
```

–ê—Ç—Ä–∏–±—É—Ç `str` –æ–±—ä–µ–∫—Ç–∞ `Series` –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –æ–±—ä–µ–∫—Ç—É `StringMethods` ‚Äî –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ–º—É –Ω–∞–±–æ—Ä—É –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å—Ç—Ä–æ–∫–æ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏. –î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å–æ —Å—Ç—Ä–æ–∫–æ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ª—É—á—à–µ –≤—ã–∑—ã–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã –æ–±—ä–µ–∫—Ç–∞ `StringMethods`, –∞ –Ω–µ —Å–∞–º–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ `Series`.

```python
inspections["Name"].str
# Out <pandas.core.strings.StringMethods at 0x122ad8510>

# lstrip - —É–¥–∞–ª—è–µ—Ç –ø—Ä–æ–±–µ–ª—ã –∏–∑ –Ω–∞—á–∞–ª–∞ —Å—Ç—Ä–æ–∫–∏
dessert = " cheesecake "
dessert.lstrip()
# Out 'cheesecake '

# rstrip - —É–¥–∞–ª—è–µ—Ç –ø—Ä–æ–±–µ–ª—ã –∏–∑ –∫–æ–Ω—Ü–∞ —Å—Ç—Ä–æ–∫–∏
# strip —É–¥–∞–ª—è–µ—Ç –ø—Ä–æ–±–µ–ª—ã —Å –æ–±–æ–∏—Ö –∫–æ–Ω—Ü–æ–≤ —Å—Ç—Ä–æ–∫–∏

# —É–¥–∞–ª—è–µ—Ç –ø—Ä–æ–±–µ–ª—ã —É —Å—Ç—Ä–æ–∫–∏ –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –µ–µ, –≤–∞—Ä–∏–∞–Ω—Ç –Ω–∏–∂–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–µ –±–æ–ª—å—à–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
inspections["Name"] = inspections["Name"].str.strip()
# –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ –±—É–¥–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –Ω–∏–∂–µ
for column in inspections.columns:
	inspections[column] = inspections[column].str.strip()
	
	
# lower - –ø—Ä–∏–≤–æ–¥–∏—Ç –≤—Å–µ —Å–∏–º–≤–æ–ª—ã —Å—Ç—Ä–æ–∫–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É
# upper - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç Series —Å–æ —Å—Ç—Ä–æ–∫–æ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ.
# capitalize - –ø—Ä–∏–≤–æ–¥–∏—Ç –≤ –≤–µ—Ä—Ö–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä –ø–µ—Ä–≤—É—é –±—É–∫–≤—É –∫–∞–∂–¥–æ–≥–æ —Å—Ç—Ä–æ–∫–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –æ–±—ä–µ–∫—Ç–µ Series
# title - –ø—Ä–∏–≤–æ–¥–∏—Ç –≤ –≤–µ—Ä—Ö–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä –ø–µ—Ä–≤—É—é –±—É–∫–≤—É –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ–≤–∞
inspections["Name"].str.capitalize().head()
```
---
#### üîπ –°—Ä–µ–∑—ã —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

```python
# replace - –∑–∞–º–µ–Ω—è–µ—Ç –≤—Å–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –¥—Ä—É–≥–∏–º –æ–±—ä–µ–∫—Ç–æ–≤ DataFrame, –≤ –ø–µ—Ä–≤–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–µ —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞, to_replace, —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏—Å–∫–æ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∞ –≤–æ –≤—Ç–æ—Ä–æ–º, value, ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä—ã–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–º–µ–Ω–∏—Ç—å –∫–∞–∂–¥–æ–µ –µ–≥–æ –≤—Ö–æ–∂–¥–µ–Ω–∏–µ.
inspections = inspections.replace(
	to_replace = "All", value = "Risk 4 (Extreme)"
)
# –¥–ª—è –º–µ—Ç–æ–¥–∞ –º–æ–∂–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
customers["Street"].str.replace(
	"\d{4,}", "*", regex = True
).head()

#¬†slice - –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –ø–æ–¥—Å—Ç—Ä–æ–∫ —Å–∏–º–≤–æ–ª–æ–≤ –∏–∑ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ –ø–æ–∑–∏—Ü–∏—è–º –∏–Ω–¥–µ–∫—Å–æ–≤
inspections["Risk"].str.slice(5, 6).head()
# –∏–ª–∏ –º–æ–∂–Ω–æ —Ç–∞–∫
inspections["Risk"].str[5:6].head()
# –µ—Å–ª–∏ —É–∫–∞–∑–∞—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç—á–µ—Ç –±—É–¥–µ—Ç –∏–¥—Ç–∏ —Å –∫–æ–Ω—Ü–∞ —Å—Ç—Ä–æ–∫–∏
inspections["Risk"].str.slice(8, -1).head()

# contains - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –≤—Ö–æ–¥–∏—Ç –ª–∏ –ø–æ–¥—Å—Ç—Ä–æ–∫–∞ –≤ –∫–∞–∂–¥–æ–µ –∏–∑ –∑–Ω–∞—á–µ–Ω–∏–π –æ–±—ä–µ–∫—Ç–∞ Series. –û–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç True, –µ—Å–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ pandas –Ω–∞—à–ª–∞ –∞—Ä–≥—É–º–µ–Ω—Ç –º–µ—Ç–æ–¥–∞ –≤–Ω—É—Ç—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç—Ä–æ–∫–∏, –∏ False, –µ—Å–ª–∏ –Ω–µ—Ç
has_pizza = inspections["Name"].str.lower().str.contains("pizza")
inspections[has_pizza]

# startswith - –≤–æ–∑–≤—Ä–∞—â–∞—è True, –µ—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ –µ–º—É –∞—Ä–≥—É–º–µ–Ω—Ç–∞
starts_with_tacos = (
	inspections["Name"].str.lower().str.startswith("tacos")
)
inspections[starts_with_tacos]

# endswith - –∏—â–µ—Ç –∑–∞–¥–∞–Ω–Ω—É—é –ø–æ–¥—Å—Ç—Ä–æ–∫—É –≤ –∫–æ–Ω—Ü–µ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –æ–±—ä–µ–∫—Ç–∞ Series
ends_with_tacos = (
	inspections["Name"].str.lower().str.endswith("tacos")
)
inspections[ends_with_tacos]
```

#### üîπ –†–∞–∑–±–∏–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

```python
# len - –ø–æ–ª—É—á–∏—Ç—å –¥–ª–∏–Ω—ã –∑–Ω–∞—á–µ–Ω–∏–π –≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ
customers["Name"].str.len().head()

# split - —Ä–∞–∑–±–∏–≤–∞–µ—Ç —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—é. –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –∑–∞–¥–∞–µ—Ç—Å—è –≤ –ø–µ—Ä–≤–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–µ —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞, pat –û–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ –≤—Å–µ—Ö –ø–æ–¥—Å—Ç—Ä–æ–∫, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–∞–∑–±–∏–µ–Ω–∏—è
phone_number = "555-123-4567"
phone_number.split("-")
# Out ['555', '123', '4567']
# –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä n - –∑–∞–¥–∞—é—â–∏–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–±–∏–µ–Ω–∏–π
phone_number.split(pat="-", n=1)
# Out ['555', '123-4567']
# –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä expand, –∏, –µ—Å–ª–∏ —É–∫–∞–∑–∞—Ç—å –¥–ª—è —ç—Ç–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∞—Ä–≥—É–º–µ–Ω—Ç True, –º–µ—Ç–æ–¥ –≤–µ—Ä–Ω–µ—Ç –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç DataFrame –≤–º–µ—Å—Ç–æ –æ–±—ä–µ–∫—Ç–∞ Series —Å–æ —Å–ø–∏—Å–∫–∞–º–∏
phone_number.split(pat="-", n=1, expand=True)
# Out
# 0 1 
# --------------
# 0 555 123-4567

# –ø—Ä–∏–º–µ—Ä –≥–¥–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—è Name –Ω–∞ First name –∏ Last Name, –∏ –∑–∞–ø–∏—Å—å —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –Ω–æ–≤—ã–µ –ø–æ–ª—è
customers[["First Name", "Last Name"]] = customers[
	"Name"
].str.split(pat = " ", n = 1, expand = True)
# —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞
customers = customers.drop(labels = "Name", axis = "columns")


# get - –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ —Å–ø–∏—Å–∫–æ–≤ —Å—Ç—Ä–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–∑–∏—Ü–∏–π –∏–Ω–¥–µ–∫—Å–∞
phone_number.str.split(pat = " ", n = 1).str.get(0)
# Out '555'
# –ê—Ä–≥—É–º–µ–Ω—Ç -1 –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –∏–∑–≤–ª–µ—á–µ–Ω–∏—é –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–ø–∏—Å–∫–∞, –≤–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, —Å–∫–æ–ª—å–∫–æ –≤ –Ω–µ–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤
```