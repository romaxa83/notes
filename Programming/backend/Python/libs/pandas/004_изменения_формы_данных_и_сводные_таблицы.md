#python #pandas #package 

–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã (reshaping) –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –æ–∑–Ω–∞—á–∞–µ—Ç –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –µ–≥–æ –≤ –¥—Ä—É–≥–æ–π –≤–∏–¥, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä—É—é –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ/—Å–ª–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –∏–∑ –¥–∞–Ω–Ω—ã—Ö –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –≤–∏–¥–µ.

#### üîπ –®–∏—Ä–æ–∫–∏–µ –∏ —É–∑–∫–∏–µ –¥–∞–Ω–Ω—ã–µ

_–®–∏—Ä–æ–∫–∏–π_ (wide) –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å—Ç–µ—Ç –ø–æ —à–∏—Ä–∏–Ω–µ, —Ä–∞–∑—Ä–∞—Å—Ç–∞–µ—Ç—Å—è.
–ü—Ä–∏–º–µ—Ä —Ç–∞–±–ª–∏—Ü–∞ —à–∏—Ä–æ–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö ( —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤ –≥–æ—Ä–æ–¥–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–µ–Ω—å), –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –≥–æ—Ä–æ–¥–∞ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Ä–∞—Å—à–∏—Ä—è—Ç—Å—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ
```
| Weekday | Miami | New York | Chicago | San Francisco |
|---------|-------|----------|---------|---------------|
| Monday  | 100   | 65       | 50      | 60            |  
| Tuesday | 105   | 70       | 58      | 62            |
```

_–£–∑–∫–∏–π_ (narrow) –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –Ω–∞–∑—ã–≤–∞—é—Ç —Ç–∞–∫–∂–µ –¥–ª–∏–Ω–Ω—ã–º (long) –∏–ª–∏ –≤—ã—Å–æ–∫–∏–º (tall). –≠—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏—è –æ—Ç—Ä–∞–∂–∞—é—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –º–µ—Ä–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö.
–ü—Ä–∏–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã —É–∑–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –≥–æ—Ä–æ–¥–æ–≤ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Ä–∞—Å—à–∏—Ä—è—Ç—å—Å—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ
```
| Weekday | City     | Temperature |
|---------|----------|-------------|
| Monday  | Miami    | 100         |
| Monday  | New York | 65          |
| Tuesday | Miami    | 105         |
| Tuesday | New York | 70          |
```

==–£–∑–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –ª–µ–≥—á–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å, —á–µ–º —à–∏—Ä–æ–∫–∏–µ.–£–∑–∫–∏–π —Ñ–æ—Ä–º–∞—Ç –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —É–ø—Ä–æ—â–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã.==

---
#### üîπ –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –∏–∑ –æ–±—ä–µ–∫—Ç–∞ `DATAFRAME`

 > –í –ø—Ä–∏–º–µ—Ä–µ –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, `sales_by_employee.csv`, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö —Å–¥–µ–ª–æ–∫ –≤—ã–º—ã—à–ª–µ–Ω–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏. –ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –≤–∫–ª—é—á–∞–µ—Ç –¥–∞—Ç—É –ø—Ä–æ–¥–∞–∂–∏ (Date), –∏–º—è/–Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ (Name), –ø–æ–∫—É–ø–∞—Ç–µ–ª—è (Customer), –∞ —Ç–∞–∫–∂–µ –≤—ã—Ä—É—á–∫—É (Revenue) –∏ –∏–∑–¥–µ—Ä–∂–∫–∏ (Expenses) –æ—Ç –ø—Ä–æ–¥–∞–∂–∏
 
```python
pd.read_csv("sales_by_employee.csv").head()
# Out 
# Date Name Customer Revenue Expenses
# --------------------------------------------------
# 0 1/1/20 Oscar Logistics XYZ 5250 531
# 1 1/1/20 Oscar Money Corp. 4406 661
# 2 1/2/20 Oscar PaperMaven 8661 1401
# 3 1/3/20 Oscar PaperGenius 7075 906
# 4 1/4/20 Oscar Paper Pound 2524 1767
```

##### üî∏ –ú–µ—Ç–æ–¥ `pivot_table`
_–°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞_ (pivot table) –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ –∏ –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –∑–Ω–∞—á–µ–Ω–∏—è–º –∏–∑ –¥—Ä—É–≥–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤. –°–ª–æ–≤–æ ¬´–∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç¬ª –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–≤–æ–¥–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –≤—ã–ø–æ–ª–Ω–∏–º —á–µ—Ç—ã—Ä–µ —à–∞–≥–∞:
- –í—ã–±–µ—Ä–µ–º —Å—Ç–æ–ª–±—Ü—ã, –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ç–æ—Ä—ã—Ö —Ö–æ—Ç–∏–º –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å.
-  –í—ã–±–µ—Ä–µ–º –ø—Ä–∏–º–µ–Ω—è–µ–º—É—é –∫ —Å—Ç–æ–ª–±—Ü–∞–º –æ–ø–µ—Ä–∞—Ü–∏—é –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.
-  –í—ã–±–µ—Ä–µ–º —Å—Ç–æ–ª–±—Ü—ã, –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–Ω–∞—á–µ–Ω–∏–π –∫–æ—Ç–æ—Ä—ã—Ö –±—É–¥–µ–º –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.
- –í—ã–±–µ—Ä–µ–º, –≥–¥–µ —Ä–∞–∑–º–µ—â–∞—Ç—å –≥—Ä—É–ø–ø—ã ‚Äî –Ω–∞ –æ—Å–∏ —Å—Ç—Ä–æ–∫, –æ—Å–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –∏–ª–∏ –Ω–∞ –æ–±–µ–∏—Ö –æ—Å—è—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç.

–†–æ–ª—å –º–µ—Ç–æ–∫ –∏–Ω–¥–µ–∫—Å–∞ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –∏–≥—Ä–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞ Date. –°—Ç–æ–ª–±–µ—Ü Date —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—è—Ç—å –Ω–µ–ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –¥–∞—Ç. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ pandas –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∫–æ –≤—Å–µ–º —á–∏—Å–ª–æ–≤—ã–º —Å—Ç–æ–ª–±—Ü–∞–º –≤ sales (Expenses –∏ Revenue) –∞–≥—Ä–µ–≥–∏—Ä—É—é—â—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏.
```python
sales.pivot_table(index = "Date")
# Out
# Date Expenses Revenue
# ------------------------------------
# 2020-01-01 637.500000 4293.500000
# 2020-01-02 1244.400000 7303.000000
# 2020-01-03 1313.666667 4865.833333
# 2020-01-04 1450.600000 3948.000000
# 2020-01-05 1196.250000 4834.750000
```
–ê–≥—Ä–µ–≥–∏—Ä—É—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–±—ä—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `aggfunc`, –∞—Ä–≥—É–º–µ–Ω—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∫–æ—Ç–æ—Ä–æ–≥–æ ‚Äî `"mean"`. –°–ª–µ–¥—É—é—â–∏–π –∫–æ–¥ –¥–∞–µ—Ç —Ç–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —á—Ç–æ –∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π
```python
sales.pivot_table(index = "Date", aggfunc = "mean")

# –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è, —Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º - summ
sales.pivot_table(index = "Date", aggfunc = "sum")

# –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞, –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–µ —Å—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å –µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏–µ–º
sales.pivot_table(
	index = "Date", values = "Revenue", aggfunc = "sum"
)

# –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —Å—Ç–æ–ª–±—Ü–∞ Name –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Å—Ç–æ–ª–±—Ü–æ–≤ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã, –Ω—É–∂–Ω–æ –≤ –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä columns, —É–∫–∞–∑–∞–≤ –¥–ª—è –Ω–µ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç "Name"
sales.pivot_table(
	index = "Date",
	columns = "Name",
	values = "Revenue",
	aggfunc = "sum"
)
# Out
# Name Creed Dwight Jim Michael Oscar
# Date
# ---------------------------------------------
# 2020-01-01 4430.0 2639.0 1864.0 7172.0 9656.0
# 2020-01-02 13214.0 NaN 8278.0 6362.0 8661.0
# 2020-01-03 NaN 11912.0 4226.0 5982.0 7075.0
# 2020-01-04 3144.0 NaN 6155.0 7917.0 2524.0
# 2020-01-05 938.0 7771.0 NaN 7837.0 2793.0

# –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è NaN –Ω—É–∂–Ω–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä - fill_value

# –î–ª—è –≤—ã–≤–æ–¥–∞ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –∏—Ç–æ–≥–æ–≤ –ø–æ –≤—Å–µ–º —Å—Ç—Ä–æ–∫–∞–º –∏ —Å—Ç–æ–ª–±—Ü–∞–º –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç True –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ margins:
sales.pivot_table(
	index = "Date",
	columns = "Name",
	values = "Revenue",
	aggfunc = "sum",
	fill_value = 0,
	margins = True
	margins_name = "Total"
)
# Out
# Name Creed Dwight Jim Michael Oscar Total
# Date
# -------------------------------------------------
# 2020-01-01 00:00:00 4430 2639 1864 7172 9656 25761
# 2020-01-02 00:00:00 13214 0 8278 6362 8661 36515
# 2020-01-03 00:00:00 0 11912 4226 5982 7075 29195
# 2020-01-04 00:00:00 3144 0 6155 7917 2524 19740
# 2020-01-05 00:00:00 938 7771 0 7837 2793 19339
# Total 21726 22322 20523 35270 30709 130550
```

==–∞—Ä–≥—É–º–µ–Ω—Ç—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `aggfunc`==
- `count` - –∞—Ä–≥—É–º–µ–Ω—Ç –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `aggfunc`, —á—Ç–æ–±—ã –ø–æ–¥—Å—á–∏—Ç–∞—Ç—å —á–∏—Å–ª–æ —Å—Ç—Ä–æ–∫ –æ–±—ä–µ–∫—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ—á–µ—Ç–∞–Ω–∏—è
- `max` - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø–µ
- `min` - –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø–µ
- `std` - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –≤ –≥—Ä—É–ø–ø–µ
- `median` - –ú–µ–¥–∏–∞–Ω–∞ (—Å—Ä–µ–¥–Ω—è—è —Ç–æ—á–∫–∞) –∑–Ω–∞—á–µ–Ω–∏–π –≤ –≥—Ä—É–ø–ø–µ
- `size` - –ß–∏—Å–ª–æ –∑–Ω–∞—á–µ–Ω–∏–π –≤ –≥—Ä—É–ø–ø–µ (—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ `count`)

–í –ø–∞—Ä–∞–º–µ—Ç—Ä `aggfunc` –º–µ—Ç–æ–¥–∞ `pivot_table` –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –¥–∞–∂–µ —Å–ø–∏—Å–æ–∫ –∞–≥—Ä–µ–≥–∏—Ä—É—é—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π. –ü—Ä–∏ —ç—Ç–æ–º —Å–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞—Å—Ç –º—É–ª—å—Ç–∏–∏–Ω–¥–µ–∫—Å –ø–æ –æ—Å–∏ —Å—Ç–æ–ª–±—Ü–æ–≤, –∞ –≥—Ä—É–ø–ø—ã –±—É–¥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ —Å–∞–º–æ–º –≤–Ω–µ—à–Ω–µ–º –µ–µ —É—Ä–æ–≤–Ω–µ.

```python
sales.pivot_table(
	index = "Date",
	columns = "Name",
	values = "Revenue",
	aggfunc = ["sum", "count"],
	fill_value = 0
)
# Out
#          sum                     count
# Name Creed Dwight Jim Michael Oscar Creed Dwight Jim Michael Oscar
# Date
# -------------------------------------------------------------------
# 2020-01-01 4430 2639 1864 7172 9656 1 1 1 1 2
# 2020-01-02 13214 0 8278 6362 8661 2 0 1 1 1
# 2020-01-03 0 11912 4226 5982 7075 0 3 1 1 1
# 2020-01-04 3144 0 6155 7917 2524 1 0 2 1 1
# 2020-01-05 938 7771 0 7837 2793 1 1 0 1 1


# –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –∞—Å—Å–∏—Ü–∏–∞—Ç–∏–≤–Ω—ã–π –º–∞—Å—Å–∏–≤, –∏ —Ç–æ–≥–¥–∞ –∫–ª—é—á–∏ –±—É–¥—É—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø
sales.pivot_table(
	index = "Date",
	columns = "Name",
	values = ["Revenue", "Expenses"],
	fill_value = 0,
	aggfunc = { "Revenue": "min", "Expenses": "max" }
)

# –ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ —Å–æ–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–æ–∫ –Ω–∞ –æ–¥–Ω–æ–π –æ—Å–∏, –ø–µ—Ä–µ–¥–∞–≤ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä index —Å–ø–∏—Å–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤
sales.pivot_table(
	index = ["Name", "Date"], values = "Revenue", aggfunc = "sum"
).head(10)
# Out
# Revenue
# Name Date
# ---------------------------
# Creed 2020-01-01 4430
#       2020-01-02 13214
#       2020-01-04 3144
# .....

# –î–ª—è –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ —É—Ä–æ–≤–Ω–µ–π –≤ –º—É–ª—å—Ç–∏–∏–Ω–¥–µ–∫—Å–µ —Å–≤–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å–ø–∏—Å–∫–µ index
sales.pivot_table(
	index = ["Date", "Name"], values = "Revenue", aggfunc = "sum"
).head(10)
# Out
#                 Revenue
# Date       Name
# ----------------------------
# 2020-01-01 Creed 4430
#            Dwight 2639
#            Jim 1864
#            Michael 7172
#            Oscar 9656
# 2020-01-02 Creed 13214
#            Jim 8278
#            Michael 6362
#            Oscar 8661
# 2020-01-03 Dwight 11912
```
---
#### üîπ –ü–µ—Ä–µ–Ω–æ—Å —É—Ä–æ–≤–Ω–µ–π –∏–Ω–¥–µ–∫—Å–æ–≤ —Å –æ—Å–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–∞ –æ—Å—å —Å—Ç—Ä–æ–∫ –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç

```python
# —Å–µ–π—á–∞—Å –¥–∞–Ω–Ω—ã–µ –≤—ã–≥–ª—è–¥—è—Ç —Ç–∞–∫
sales.head()
# Out
#    Date      Name   Customer   Revenue Expenses
# -----------------------------------------------------
# 0 2020-01-01 Oscar Logistics XYZ 5250 531
# 1 2020-01-01 Oscar Money Corp. 4406 661
# 2 2020-01-02 Oscar PaperMaven 8661 1401
# 3 2020-01-03 Oscar PaperGenius 7075 906
# 4 2020-01-04 Oscar Paper Pound 2524 1767

# –°–æ–∑–¥–∞–¥–∏–º —Å–≤–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –ø—Ä–æ–¥–∞–∂, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–≤ –≤—ã—Ä—É—á–∫—É –ø–æ –∏–º–µ–Ω–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –∏ –¥–∞—Ç–µ. –î–∞—Ç—ã –º—ã —Ä–∞–∑–º–µ—Å—Ç–∏–º –ø–æ –æ—Å–∏ —Å—Ç–æ–ª–±—Ü–æ–≤, –∞ –∏–º–µ–Ω–∞ ‚Äî –ø–æ –æ—Å–∏ —Å—Ç—Ä–æ–∫
by_name_and_date = sales.pivot_table(
	index = "Name",
	columns = "Date",
	values = "Revenue",
	aggfunc = "sum"
)
by_name_and_date.head(2)
# Out
# Date 2020-01-01 2020-01-02 2020-01-03 2020-01-04 2020-01-05
# Name
# ------------------------------------------------------------------
# Creed 4430.0 13214.0 NaN 3144.0 938.0
# Dwight 2639.0 NaN 11912.0 NaN 7771.0

# –ú–µ—Ç–æ–¥ stack –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç —É—Ä–æ–≤–µ–Ω—å –∏–Ω–¥–µ–∫—Å–∞ —Å –æ—Å–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–∞ –æ—Å—å —Å—Ç—Ä–æ–∫. –í —Å–ª–µ–¥—É—é—â–µ–º–ø—Ä–∏–º–µ—Ä–µ –º—ã –ø–µ—Ä–µ–Ω–æ—Å–∏–º —É—Ä–æ–≤–µ–Ω—å –∏–Ω–¥–µ–∫—Å–∞ Date —Å –æ—Å–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–∞ –æ—Å—å —Å—Ç—Ä–æ–∫. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ pandas —Å–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç MultiIndex –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–≤—É—Ö —É—Ä–æ–≤–Ω–µ–π –ø–æ —Å—Ç—Ä–æ–∫–∞–º: Name –∏ Date. –ê –ø–æ—Å–∫–æ–ª—å–∫—É –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Å—Ç–æ–ª–±–µ—Ü –∑–Ω–∞—á–µ–Ω–∏–π, –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ pandas –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç Series
by_name_and_date.stack().head(7)
# Out
# Name Date
# Creed 2020-01-01 4430.0
#       2020-01-02 13214.0
#       2020-01-04 3144.0
#       2020-01-05 938.0
# Dwight 2020-01-01 2639.0
#        2020-01-03 11912.0
#        2020-01-05 7771.0

# unstack –º–µ—Ç–æ–¥ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç —É—Ä–æ–≤–µ–Ω—å –∏–Ω–¥–µ–∫—Å–∞ —Å –æ—Å–∏ —Å—Ç—Ä–æ–∫ –Ω–∞ –æ—Å—å —Å—Ç–æ–ª–±—Ü–æ–≤
```
---
#### üîπ –†–∞—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö 

–°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö.–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–µ: –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—é –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –Ω–µ–∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π.
–î–ª—è —Ä–∞—Å–ø–ª–∞–≤–ª–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ DataFrame –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ pandas —Å–ª—É–∂–∏—Ç –º–µ—Ç–æ–¥ `melt` (—Ä–∞—Å–ø–ª–∞–≤–ª–µ–Ω–∏–µ–º (melting) –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —à–∏—Ä–æ–∫–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —É–∑–∫–∏–π). –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞:
- `id_vars` –∑–∞–¥–∞–µ—Ç —Å—Ç–æ–ª–±–µ—Ü-–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –∞–≥—Ä–µ–≥–∏—Ä—É—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ —à–∏—Ä–æ–∫–æ–≥–æ –Ω–∞–±–æ—Ä–∞. –°—Ç–æ–ª–±–µ—Ü-–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–∞–±–æ—Ä–∞ video_game_sales - Name. –¢–æ –µ—Å—Ç—å –∞–≥—Ä–µ–≥–∏—Ä—É—é—Ç—Å—è –ø—Ä–æ–¥–∞–∂–∏ –ø–æ –∫–∞–∂–¥–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–π –∏–≥—Ä–µ.
- ¬†`value_vars` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å—Ç–æ–ª–±–µ—Ü (-—ã), –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—Ç–æ—Ä–æ–≥–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ pandas —Ä–∞—Å–ø–ª–∞–≤–ª—è–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –Ω–æ–≤–æ–º —Å—Ç–æ–ª–±—Ü–µ.

> –°–ª–µ–¥—É—é—â–∏–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, video_game_sales.csv, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–ø–∏—Å–æ–∫ –º–µ—Å—Ç–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã—Ö –∏–≥—Ä. –ö–∞–∂–¥–∞—è –∏–∑ —Å—Ç—Ä–æ–∫ –≤–∫–ª—é—á–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã, –∞ —Ç–∞–∫–∂–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü —Ç–æ–≤–∞—Ä–∞ (–≤ –º–∏–ª–ª–∏–æ–Ω–∞—Ö) –≤ –°–µ–≤–µ—Ä–Ω–æ–π –ê–º–µ—Ä–∏–∫–µ (NA), –ï–≤—Ä–æ–ø–µ (EU), –Ø–ø–æ–Ω–∏–∏ (JP) –∏ –¥—Ä—É–≥–∏—Ö (Other) —Ä–µ–≥–∏–æ–Ω–∞—Ö

```python
video_game_sales.head(1)
# Out
# Name        NA    EU   JP   Other
# ----------------------------------
# Wii Sports 41.49 29.02 3.77 8.46

# —Ä–∞—Å–ø–ª–∞–≤–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –æ–¥–Ω–æ–≥–æ —Ç–æ–ª—å–∫–æ —Å—Ç–æ–ª–±—Ü–∞ NA, pandas –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤ —Ü–∏–∫–ª–µ –ø–æ –≤—Å–µ–º –∑–Ω–∞—á–µ–Ω–∏—è–º —Å—Ç–æ–ª–±—Ü–∞ NA, —Å–æ–∑–¥–∞–≤–∞—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—Ç—Ä–æ–∫—É –≤ –Ω–æ–≤–æ–º –æ–±—ä–µ–∫—Ç–µ DataFrame. Pandas —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–µ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ (NA) –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å—Ç–æ–ª–±—Ü–µ variable
video_game_sales.melt(id_vars = "Name", value_vars = "NA").head()
# Out
# Name                variable value
# -----------------------------
# Wii Sports               NA 41.49
# Super Mario Bros.        NA 29.08
# Mario Kart Wii           NA 15.85
# Wii Sports Resort        NA 15.75
# Pokemon Red/Pokemon Blue NA 11.27

# –¢–µ–ø–µ—Ä—å —Ä–∞—Å–ø–ª–∞–≤–∏–º –≤—Å–µ —á–µ—Ç—ã—Ä–µ —Å—Ç–æ–ª–±—Ü–∞ –ø—Ä–æ–¥–∞–∂ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º –∏ –∑–∞–¥–∞–¥–∏–º —Å–≤–æ–∏ –Ω–∞–∑–≤–∞–Ω–∏—è —Ä–∞—Å–ø–ª–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
regional_sales_columns = ["NA", "EU", "JP", "Other"]
video_game_sales.melt(
	id_vars = "Name", 
	value_vars = regional_sales_columns
	var_name = "Region",
	value_name = "Sales"
)
# Out
# Name Region Sales
# -----------------------------------------
# Wii Sports NA 41.49
# Super Mario Bros. NA 29.08
# Mario Kart Wii NA 15.85
# Wii Sports Resort NA 15.75
# Pokemon Red/Pokemon Blue NA 11.27
# .....

# –ò —Ç–µ–ø–µ—Ä—å, –¥–æ–ø—É—Å—Ç–∏–º, –Ω–∞–º –Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å —Å—É–º–º—É –ø—Ä–æ–¥–∞–∂ –∫–∞–∂–¥–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–π –∏–≥—Ä—ã –ø–æ –≤—Å–µ–º —Ä–µ–≥–∏–æ–Ω–∞–º. –í–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–≤—à–∏—Å—å —Ä–∞—Å–ø–ª–∞–≤–ª–µ–Ω–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö, –º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É –ø—Ä–∏ –ø–æ–º–æ—â–∏ –≤—Å–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ pivot_tabl
video_game_sales_by_region.pivot_table(
	index = "Name", values = "Sales", aggfunc = "sum"
).head()
```

##### üî∏ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π

–ò–Ω–æ–≥–¥–∞ –≤ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –æ–¥–Ω–∞ —è—á–µ–π–∫–∞ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–π (–∫–ª–∞—Å—Ç–µ—Ä). –ò –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —Ä–∞–∑–±–∏—Ç—å —Ç–∞–∫–æ–π –∫–ª–∞—Å—Ç–µ—Ä –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ —Å–æ–¥–µ—Ä–∂–∞–ª–æ—Å—å –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ.
```python
recipes = pd.read_csv("recipes.csv")
recipes
# Out
# Recipe Ingredients
# -------------------------------------------------------------------
# Cashew Crusted Chicken Apricot preserves, Dijon mustard, cu...
# Tomato Basil Salmon Salmon filets, basil, tomato, olive ...
# Parmesan Cheese Chicken Bread crumbs, Parmesan cheese, Itali...

recipes["Ingredients"] = recipes["Ingredients"].str.split(",")
# –ú–µ—Ç–æ–¥ explode —Å–æ–∑–¥–∞–µ—Ç –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–ø–∏—Å–∫–∞ –≤ –æ–±—ä–µ–∫—Ç–µ Series
recipes.explode("Ingredients")
# Out
# Recipe Ingredients
# ---------------------------------------------
# 0 Cashew Crusted Chicken Apricot preserves
# 0 Cashew Crusted Chicken Dijon mustard
# 0 Cashew Crusted Chicken curry powder
# 0 Cashew Crusted Chicken chicken breasts
# 0 Cashew Crusted Chicken cashews
# 1 Tomato Basil Salmon Salmon filets
# 1 Tomato Basil Salmon basil
# 1 Tomato Basil Salmon tomato
# 1 Tomato Basil Salmon olive oil
# 1 Tomato Basil Salmon Parmesan cheese
# 2 Simply Parmesan Cheese Bread crumbs
# 2 Simply Parmesan Cheese Parmesan cheese
# 2 Simply Parmesan Cheese Italian seasoning
# 2 Simply Parmesan Cheese egg
# 2 Simply Parmesan Cheese chicken breasts
```
---
