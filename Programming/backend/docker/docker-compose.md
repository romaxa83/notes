#docker 

### üîπ Install
###### üî∏ Linux

```bash
sudo¬†curl¬†-L¬†"https://github.com/docker/compose/releases/download/v2.24.6/docker-compose-$(uname-s)-$(uname¬†-m)"¬†-o¬†/usr/local/bin/docker-compose

sudo¬†chmod¬†+x¬†/usr/local/bin/docker-compose

docker-compose -v
```

> v2.24.6 - —ç—Ç–æ –≤–µ—Ä—Å–∏—è –ø–∞–∫–µ—Ç–∞, –Ω–∞ –º–æ–º–µ–Ω—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω—É–∂–Ω–æ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç–∞–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é
---
### üîπ –ö–æ–º–∞–Ω–¥—ã –≤ –∫–æ–Ω—Å–æ–ª–∏

> –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∫–æ–º–∞–Ω–¥ `docker` (–∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤–µ–∑–¥–µ), –∫–æ–º–∞–Ω–¥—ã `docker-compose` –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç–µ –≥–¥–µ –≤ –∫–æ—Ä–Ω–µ –∏–º–µ–µ—Ç—Å—è —Ñ–∞–π–ª `docker-compose.yml` –∏–ª–∏ —É–∫–∞–∑—ã–≤–∞—Ç—å –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥ `-f`

üî∏ —Å–æ–±–∏—Ä–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã 
```bash
docker-compose build
```

üî∏ –∑–∞–ø—É—Å—Ç–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
```bash
docker-compose up

// –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
docker-compose up -d

// –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–µ—Å–ª–∏ –≤ –Ω–µ–≥–æ –±—ã–ª–∏ –≤–Ω–µ—Å–µ–Ω—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è)
docker-compose up --build -d

// —Å–æ–∑–¥–∞—Å—Ç —Å–µ—Ä–≤–∏—Å –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ –∫–æ–ª-–≤–µ 3 —à—Ç—É–∫
docker-compose up -d --scale mysql=3

// –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏—Å–ø–æ–ª—å–∑—É—è –¥—Ä—É–≥–æ–π —Ñ–∞–π–ª
docker-compose -f docker-compose-production.yml up
```

üî∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```bash
docker-compose exec <SERVICE> php artisan

docker-compose exec php php artisan
```
>SERVICE - –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ –≤ —Ñ–∞–π–ª–µ docker-compose

üî∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã 
```bash
docker-compose down

// –æ—á–∏—Å—Ç–∏—Ç –≤—Å–µ –∑–∞–ø—É—â–µ–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down --remove-orphans

// —Ñ–ª–∞–≥ -v —É–¥–∞–ª—è–µ—Ç –≤—Å–µ volume (–æ—á–∏—â–∞–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ)
docker-compose down -v
```

üî∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –∑–∞–ø—É—â–µ–Ω–Ω—ã–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º
```bash
docker-compose ps
```

üî∏–ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
```bash
docker-compose logs -f name_container 
```

üî∏–ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```bash
docker-compose config 
```
---
### üîπ–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–µ—Ä–≤–∏—Å–æ–≤

üî∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `restart`
*–ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å —Å–µ—Ä–≤–∏—Å –≤ —Å–ª—É—á–∞–µ –µ–≥–æ –ø–∞–¥–µ–Ω–∏—è*
```yml
api:
  restart: always // –±—É–¥–µ—Ç –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å —Å–µ—Ä–≤–∏—Å
```

üî∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `profiles`
*—Å –ø–æ–º–æ—â—å—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ `profiles`, –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª—è—Ç—å –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª—ã, —Ç.–µ. –µ—Å–ª–∏ –∑–∞–ø—É—Å–∫ –∫–∞–∫–æ–≥–æ-—Ç–æ —Å–µ—Ä–≤–∏—Å–∞ –Ω–µ –≤—Å–µ–≥–¥–∞ –Ω—É–∂–Ω–æ, –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Å–µ—Ä–≤–∏—Å–∞—Ö –Ω–∞ –ø–æ–¥–æ–±–µ–µ backup –∏ –ø–æ—Ö–æ–∂–∏—Ö*
```yml
api:
	....
  profiles: ["backend"]
  	....
```

*–ø—Ä–∏ –æ–±—ã—á–Ω–æ–º –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–∏—Å–æ–≤, –¥–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å –Ω–µ –ø–æ–¥—ã–º–∏—Ç—Å—è,
—á—Ç–æ–± –µ–≥–æ –ø–æ–¥–Ω—è—Ç—å –Ω—É–∂–Ω–æ, –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —É–∫–∞–∑—ã–≤–∞—Ç—å —Ñ–ª–∞–≥ profiles. –ï—Å—Ç—å –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å*

```bash
docker-compose --profile backend up -d

// –µ—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Ñ–∞–π–ª–æ–≤
docker-compose --profile backend --profile queue up -d
```
–∏–ª–∏
```bash
COMPOSE_PROFILES=backend docker-compose up -d
```
---
### üîπ–î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤

üî∏ –º–µ—Ä–¥–∂ –∫–æ–Ω—Ñ–∏–≥–æ–≤
*–º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª—è—Ç—å —Ñ–∞–π–ª—ã d-c, —Å–æ–∑–¥–∞–≤–∞—è —Ä–∞–∑–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è –¥–µ–≤–∞ –∏ –ø—Ä–æ–¥–∞
–∫ –ø—Ä–∏–º–µ—Ä—É —Å–æ–∑–¥–∞–µ–º –±–∞–∑–æ–≤—ã–π —Ñ–∞–π–ª —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —Å–µ—Ä–≤–∏—Å–æ–≤*
```yml
version: "3.7"
services:
    nginx:
        build:
            context: docker
            dockerfile: dev/nginx/Dockerfile
        volumes:
            - ./:/app
            - ./storage/logs:/var/log/nginx
        restart: always
```

*–∑–∞—Ç–µ–º —Å–æ–∑–¥–∞–µ–º, –∫ –ø—Ä–∏–º–µ—Ä—É, —Ñ–∞–π–ª –¥–ª—è –¥–µ–≤–∞ docker-compose.dev.yaml, –≥–¥–µ —É–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Ä—Ç—ã*
```yml
version: "3.7"
services:
    nginx:
        ports:
            - 80:8080
```

*–∏ –∑–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–∏—Å—ã, –ø—Ä–∏ —ç—Ç–æ–º –º–µ—Ä–¥–∂–∏–º —Ñ–∞–π–ª—ã, –ø–µ—Ä–≤—ã–º —É–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π
—Ñ–∞–π–ª, –≤—Ç–æ—Ä—ã–º - –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –ø—Ä–∏–º–µ—Ä–¥–∂–∏—Ç—å, –∏–∑ –≤—Ç–æ—Ä–æ–≥–æ —Ñ–∞–π–ª–∞ –¥–∞–Ω–Ω—ã–µ –¥–æ–ø–æ–ª–Ω—è—Ç—å—Å—è –∫ –ø–µ—Ä–≤–æ–º—É*
```bash
docker-compose -f docker-compose.yml -f docker-compose.dev.yml up -d
```

*–º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –∫–æ–Ω–µ—á–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥*
```bash
docker-compose -f docker-compose.yml -f docker-compose.dev.yml config
```

üî∏ –≤—ã–Ω–æ—Å —Å–µ—Ä–≤–∏—Å–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥
*–æ–ø–∏—Å–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ (–µ—Å–ª–∏ –æ–Ω–∏ –±–æ–ª—å—à–∏–µ), –º–æ–∂–Ω–æ –≤—ã–Ω–æ—Å–∏—Ç—å –≤
–æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã, –∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—å –∏—Ö –æ—Å–Ω–æ–≤–Ω–æ–º—É —Ñ–∞–π–ª—É.*

*—Å–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª —Å —Å–µ—Ä–≤–∏—Å–æ–º - docker-compose.nginx.yml*
```yml
version: "3.7"
services:

    nginx:
        build:
            context: docker
            dockerfile: dev/nginx/Dockerfile
        container_name: ${APP_NAME}__nginx
        hostname: ${APP_NAME}__nginx
        volumes:
            - ./:/app
            - ./storage/logs:/var/log/nginx
        ports:
            - ${DOCKER_BRIDGE}:80:80
        restart: always
```

*–≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ñ–∞–π–ª–µ –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ –∏–∑ –¥—Ä—É–≥–æ–≥–æ
—Ñ–∞–π–ª–∞, (–µ—Å–ª–∏ —É —Å–µ—Ä–≤–∏—Å–∞ –µ—Å—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è depends_on, 
–µ–µ –Ω—É–∂–Ω–æ –æ–ø–∏—Å—ã–≤–∞—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ñ–∞–π–ª–µ)*
```yml
version: "3.7"
services:

    nginx:
        extends:
        	file: docker-compose.nginx.yml
        	service: nginx
        depends_on:
        	- php
```

---
