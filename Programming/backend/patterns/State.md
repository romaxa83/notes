#pattern #php #snippet #architecture
–ü–∞—Ç—Ç–µ—Ä–Ω **State (–°–æ—Å—Ç–æ—è–Ω–∏–µ)** ‚Äî —ç—Ç–æ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç—É –∏–∑–º–µ–Ω—è—Ç—å —Å–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è. –ù–∞ –ø–µ—Ä–≤—ã–π –≤–∑–≥–ª—è–¥, —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫, –∫–∞–∫ –±—É–¥—Ç–æ –æ–±—ä–µ–∫—Ç –∏–∑–º–µ–Ω—è–µ—Ç —Å–≤–æ–π –∫–ª–∞—Å—Å. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ "State" –ø–æ–º–æ–≥–∞–µ—Ç —Å–¥–µ–ª–∞—Ç—å –∫–æ–¥ –±–æ–ª–µ–µ –≥–∏–±–∫–∏–º, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º –∏ —á–∏—Ç–∞–µ–º—ã–º, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.

---

#### –û–ø–∏—Å–∞–Ω–∏–µ
–ü–∞—Ç—Ç–µ—Ä–Ω State –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —É –æ–±—ä–µ–∫—Ç–∞ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π, –∏ –µ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–≤–µ—Ç–≤–ª—è—é—â–∏–µ—Å—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (`if` –∏–ª–∏ `switch`) –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è, –ø–∞—Ç—Ç–µ—Ä–Ω –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –≤—ã–Ω–µ—Å—Ç–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã.

#### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
* üîπ  **–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π**. –ö–∞–∂–¥–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚Äî —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –≤ —ç—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏.
* üîπ  **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π**. –û–±—ä–µ–∫—Ç –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å —Å–≤–æ–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π.
* üîπ  **–ò–∑–±–µ–≥–∞–Ω–∏–µ –≥—Ä–æ–º–æ–∑–¥–∫–∏—Ö —É—Å–ª–æ–≤–∏–π**. –í–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ `if-else`/`switch` —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–¥–∞—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –æ–±—ä–µ–∫—Ç–æ–≤.

#### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
* üîπ –ö–æ–≥–¥–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –∏ —ç—Ç–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–Ω–æ–≥–æ.
* üîπ –ö–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ–±—ã –æ–±—ä–µ–∫—Ç –∏–∑–º–µ–Ω—è–ª —Å–≤–æ—ë –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤ —Ö–æ–¥–µ —Å–≤–æ–µ–π —Ä–∞–±–æ—Ç—ã.
* üîπ –ö–æ–≥–¥–∞ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –≥—Ä–æ–º–æ–∑–¥–∫–∏—Ö —É—Å–ª–æ–≤–Ω—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ü–µ–ø–æ—á–µ–∫ `if-else` –∏–ª–∏ `switch-case`), –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è.

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
* üîπ **–ò–∑–æ–ª—è—Ü–∏—è –ª–æ–≥–∏–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π**. –ú–µ–Ω—å—à–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞, —Ç–∞–∫ –∫–∞–∫ –∫–∞–∂–¥–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–æ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∫–ª–∞—Å—Å–µ.
* üîπ **–£–ø—Ä–æ—â–µ–Ω–∏–µ –∫–æ–¥–∞**. –£—Å—Ç—Ä–∞–Ω—è—é—Ç—Å—è —Å–ª–æ–∂–Ω—ã–µ, –≥—Ä–æ–º–æ–∑–¥–∫–∏–µ —É—Å–ª–æ–≤–∏—è.
* üîπ **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è**. –ù–æ–≤—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å, —Å–æ–∑–¥–∞–≤–∞—è –Ω–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º –∫–æ–¥–µ ‚Äî –ø—Ä–∏–Ω—Ü–∏–ø –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç–∏/–∑–∞–∫—Ä—ã—Ç–æ—Å—Ç–∏ (**Open/Closed Principle**).
* üîπ **–£–¥–æ–±—Å—Ç–≤–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**. –°–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö –ø—Ä–æ—â–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

#### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
* üî∏ **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —á–∏—Å–ª–∞ –∫–ª–∞—Å—Å–æ–≤**. –ö–∞–∂–¥–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ä–æ—Å—Ç—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤/–æ–±—ä–µ–∫—Ç–æ–≤.
* üî∏ **–°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**. –¢—Ä–µ–±—É–µ—Ç—Å—è —É–º–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å—ã –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∏—Ö –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É.
* üî∏ **–ú–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω—ã–º –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞–µ–≤**. –ï—Å–ª–∏ —É –æ–±—ä–µ–∫—Ç–∞ –º–∞–ª–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–æ–ø—Ä–∞–≤–¥–∞–Ω–Ω—ã–º.

#### ‚ùóÔ∏è –ö–æ–≥–¥–∞ –∏–∑–±–µ–≥–∞—Ç—å
* üîπ –ï—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π –Ω–µ–≤–µ–ª–∏–∫–æ, –∏ –æ–Ω–∏ —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—Ç—Å—è.
* üîπ –ï—Å–ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –Ω–µ –æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤–ª–∏—è–Ω–∏—è –Ω–∞ –µ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ.
* üîπ –í —Å–∏—Ç—É–∞—Ü–∏—è—Ö, –≥–¥–µ –≤–∞–∂–Ω–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤.

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ PHP
*–ü—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞, –∏–º–∏—Ç–∏—Ä—É—é—â–µ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –¥–≤—É—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö: –æ–±—ã—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (—Ç–µ–∫—Å—Ç –º–æ–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å) –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–∂–∏–º–∞ "—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ".*
``` php
<?php

// –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è
interface State
{
    public function write(string $text): void;
}

// –ö–æ–Ω—Ç–µ–∫—Å—Ç - —Ä–µ–¥–∞–∫—Ç–æ—Ä
class TextEditor
{
    // –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    private State $state;

    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    public function setState(State $state): void
    {
        $this->state = $state;
    }

    // –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—é
    public function type(string $text): void
    {
        $this->state->write($text);
    }
}

// –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
class EditingState implements State
{
    public function write(string $text): void
    {
        echo "Writing: $text\n";
    }
}

// –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: —Ä–µ–∂–∏–º —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ
class ReadOnlyState implements State
{
    public function write(string $text): void
    {
        echo "Cannot write in Read-Only mode.\n";
    }
}

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
$editor = new TextEditor();

// –†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
$editor->setState(new EditingState());
$editor->type("Hello, World!"); // Output: Writing: Hello, World!

// –†–µ–∂–∏–º —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏—è
$editor->setState(new ReadOnlyState());
$editor->type("Hello, again!"); // Output: Cannot write in Read-Only mode.
```

#### –†–µ–∞–ª—å–Ω—ã–µ –∫–µ–π—Å—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
* üî∏ **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏**:
    - –ó–∞–∫–∞–∑—ã –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–µ: —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–æ–≥—É—Ç –±—ã—Ç—å "–û–∂–∏–¥–∞–Ω–∏–µ –æ–ø–ª–∞—Ç—ã", "–û–ø–ª–∞—á–µ–Ω–æ", "–î–æ—Å—Ç–∞–≤–∫–∞", "–ó–∞–≤–µ—Ä—à–µ–Ω–æ".
* üî∏ **–ò–≥—Ä—ã**:
    - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è: "–ê—Ç–∞–∫—É–µ—Ç", "–ë–µ–∂–∏—Ç", "–°–∫—Ä—ã–≤–∞–µ—Ç—Å—è".
* üî∏ **–¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä—ã**:
    - –í–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ —Ä–µ–∂–∏–º–∞ "—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ".
* üî∏ **Workflows (–°–∏—Å—Ç–µ–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö)**:
    - –°—Ç–∞—Ç—É—Å —Ä–∞–±–æ—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–æ–≤: "–û–∂–∏–¥–∞–Ω–∏–µ", "–í –ø—Ä–æ—Ü–µ—Å—Å–µ", "–û—à–∏–±–∫–∏", "–ó–∞–≤–µ—Ä—à–µ–Ω–æ".
* üî∏ **–ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã**:
    - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: "–ê–∫—Ç–∏–≤–Ω—ã–π", "–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–π", "–í—ã–∫–ª—é—á–µ–Ω".

#### **–†–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã**
* üî∏ **–î–æ—Ä–æ–∂–Ω—ã–π —Å–≤–µ—Ç–æ—Ñ–æ—Ä**:
    - –°–æ—Å—Ç–æ—è–Ω–∏—è "–ó–µ–ª—ë–Ω—ã–π", "–ñ—ë–ª—Ç—ã–π", "–ö—Ä–∞—Å–Ω—ã–π".
    - –ü–æ–≤–µ–¥–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ (–°–≤–µ—Ç–æ—Ñ–æ—Ä) –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Ü–≤–µ—Ç–∞ —Å–∏–≥–Ω–∞–ª–∞.
* üî∏ **–ë–∞–Ω–∫–æ–º–∞—Ç**:
    - –°–æ—Å—Ç–æ—è–Ω–∏—è: "–û–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ –∫–∞—Ä—Ç—ã", "–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è", "–í—ã–±–æ—Ä –æ–ø–µ—Ä–∞—Ü–∏–∏", "–í—ã–≤–æ–¥ –Ω–∞–ª–∏—á–Ω—ã—Ö".
* üî∏ **–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**:
    - –°–æ—Å—Ç–æ—è–Ω–∏—è: "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è", "–í –æ–±—Ä–∞–±–æ—Ç–∫–µ", "–ü—Ä–æ–≤–∞–ª–µ–Ω–æ", "–£—Å–ø–µ—Ö".