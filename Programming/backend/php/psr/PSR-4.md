#php #psr 
[PSR-4](https://www.php-fig.org/psr/psr-4/) — это стандарт автозагрузки классов в PHP, разработанный PHP-FIG (_PHP Framework Interop Group_). Полное название — **"PSR-4: Autoloader Standard"**. Он предлагает правила, как классы и пространства имен должны быть организованы в файловой структуре ваших проектов, чтобы обеспечить корректную автозагрузку классов без необходимости явного подключения `require`/`include`.
Этот стандарт заменяет предыдущий стандарт автозагрузки **PSR-0**, предлагая более упрощенный и современный подход.

---

#### Основная идея PSR-4
PSR-4 описывает соглашение между пространствами имен (`namespace`) и структурой папок в проекте. Подразумевается, что:
1. **Каждое пространство имен (`namespace`) классов должно соответствовать директории вашего проекта.**
2. **Имена классов должны соответствовать файлам.**
3. В результате, автозагрузчик сможет автоматически найти нужные классы, следуя этим соглашениям.

#### Структура соответствия
- Пространства имен (`namespace`) должны соответствовать структуре директорий.
- Имя класса должно быть таким же, как имя файла (учитывая регистр!).

Пример:
- Если у класса `MyNamespace\SubNamespace\MyClass` такой путь:

``` php
  src/MyNamespace/SubNamespace/MyClass.php
```

Тогда PSR-4 автозагрузка сможет найти его автоматически.

#### Пример в коде:
``` php
namespace MyNamespace\SubNamespace;

class MyClass
{
    public function sayHello()
    {
        return "Hello from MyClass!";
    }
}
```
Файл должен быть расположен по пути:
``` php
src/MyNamespace/SubNamespace/MyClass.php
```

#### Требования PSR-4
1. Пространство имен верхнего уровня называется **базовым пространством имен**.
2. Пространство имен может быть "сопоставлено" с любой директорией в вашем проекте.
3. Имя классов должно полностью соответствовать их расположению в файлах. Например, класс `Namespace\ClassName` должен находиться в файле `Namespace/ClassName.php`.

### Использование PSR-4 в проектах

#### 1.Настройка автозагрузки с помощью [Composer](https://getcomposer.org/)
`composer` — популярный инструмент в PHP, который поддерживает PSR-4 для автозагрузки. Для настройки автозагрузки нужно добавить секцию `autoload` в файл `composer.json`.

Пример:
``` json
{
    "autoload": {
        "psr-4": {
            "MyNamespace\\": "src/"
        }
    }
}
```
#### Объяснение:
- `"MyNamespace\\"`: базовое пространство имен для вашего кода.
- `"src/"`: папка, где находится код.

Теперь все классы с пространством имен `MyNamespace` будут искаться в папке `src`.

#### 2. **Генерация автозагрузчика**
После настройки файла `composer.json` выполните команду:
``` bash
composer dump-autoload
```

Это создаст файл `vendor/autoload.php`, который можно подключить в ваш проект для включения автозагрузки:
``` php
require 'vendor/autoload.php';
```

Теперь, если вы напишете:
``` php
use MyNamespace\SubNamespace\MyClass;

$obj = new MyClass();
echo $obj->sayHello();
```

Класс `MyClass` будет загружен автоматически.

#### Преимущества PSR-4
1. **Современность.**
    - Более простой и гибкий подход по сравнению с PSR-0.
    - Удаляет устаревшие и ненужные ограничения (например, нижние подчеркивания в PSR-0).

2. **Логика поиска.**
    - Упрощает организацию проекта: любое изменение пространства имен автоматически меняет путь к файлам.

3. **Совместимость с Composer.**
    - PSR-4 поддерживается большинством современных фреймворков (например, Laravel, Symfony, Yii) и библиотек.

4. **Универсальность.**
    - Поддерживает несколько корневых пространств имен:
``` json
     "autoload": {
         "psr-4": {
             "NamespaceOne\\": "src/dir1/",
             "NamespaceTwo\\": "src/dir2/"
         }
     }
```
5. **Производительность.**
    - PSR-4 упрощает поиск классов, что делает автозагрузку более быстрой.

#### Отличие PSR-4 от PSR-0

| **Критерий**                      | **PSR-0**                                            | **PSR-4**                            |
| --------------------------------- | ---------------------------------------------------- | ------------------------------------ |
| **Статус**                        | Устарел и не рекомендуется                           | Современный стандарт                 |
| **Пространство имён и структура** | Полное соответствие неймспейса с файловой структурой | Гибкая настройка с префиксом         |
| **Гибкость конфигурации**         | Жёсткое соблюдение структуры каталогов               | Настройка через `composer.json`      |
| **Символ подчеркивания `_`**      | Обрабатывается как разделитель директорий            | Не имеет особого значения            |
| **Совместимость с Legacy-кодом**  | Совместим с кодом до PHP 5.3                         | Не совместим                         |
| **Основное назначение**           | Для старых проектов                                  | Для современных PHP-приложений       |
| **Стандарт настройки**            | Работает строго с корневыми путями                   | Может указывать произвольный префикс |