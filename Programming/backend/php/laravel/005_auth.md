#php #laravel #auth #rbac

#### ðŸ”¹ AUTH

> Ð¤Ð°ÑÐ°Ð´ `Auth` (ÐÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ) Ð¿Ñ€ÐµÐ´Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½ Ð´Ð»Ñ Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð¾Ð½ ÑÐ²ÐµÑ€ÑÐµÑ‚ Ð²Ð²ÐµÐ´ÐµÐ½Ð½Ñ‹Ðµ ÑƒÑ‡ÐµÑ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½Ñ‘Ð½Ð½Ñ‹Ð¼Ð¸ ÐµÑÐ»Ð¸ ÑÑ‚Ð¾ Ð½Ðµ ÑƒÐ´Ð°ÐµÑ‚ÑÑ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ, Ñ‚Ð¾ Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ `HTTP-ÐºÐ¾Ð´ 401`. ÐÐ²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¶Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¾ Ð»Ð¸ Ð²Ð°Ð¼ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¾Ð³Ð¾ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ. ÐÐ²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð²ÑÐµÐ³Ð´Ð° Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ñ‚ Ð¿Ð¾ÑÐ»Ðµ ÐÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸

```php
// Ð·Ð°Ð»Ð¾Ð³Ð¸Ð½Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
// Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ñ‡Ñ‚Ð¾ Ð±Ñ‹ user Ð¸Ð¼Ð¿Ð»ÐµÐ¼ÐµÐ½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð» interface Authenticatable
use Illuminate\Support\Facades\Auth

Auth::login($user);

// Ñ€Ð°Ð·Ð»Ð¾Ð³Ð¸Ð½Ð¸Ð²Ð°ÐµÑ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
Auth::logout();

// Ð²ÐµÑ€Ð½ÐµÑ‚ Ð¾Ð±ÑŒÐµÐºÑ‚ Ð·Ð°Ð»Ð¾Ð³Ð¸Ð½Ð¸Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
Auth::user();

// Ð—Ð°Ð»Ð¾Ð³Ð¸Ð½Ð¸Ñ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ,ÐµÑÐ»Ð¸ Ð² Ð±Ð´ Ð½Ð°Ð¹Ð´ÐµÑ‚ ÐµÐ³Ð¾ Ð¿Ð¾ Ð¿ÐµÑ€ÐµÐ´Ð°Ð½Ð¾Ð¼Ñƒ email Ð¸ Ð¿Ð°Ñ€Ð¾Ð»ÑŽ,Ð¸Ð½Ð°Ñ‡Ðµ Ð²ÐµÑ€Ð½ÐµÑ‚ false
Auth::attempt([
	'email' => $request->get('email'),
	'password' => $request->get('password'),
]);

// Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð·Ð°Ð»Ð¾Ð³Ð¸Ð½Ð¸Ð½Ñ‹Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¸Ð»Ð¸ Ð½ÐµÑ‚ (Ð²ÐµÑ€Ð½ÐµÑ‚ true or false)
Auth::check();

// Ð°ÑƒÑ‚ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð´Ð»Ñ Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° (ÐµÑÐ»Ð¸ Ð½Ðµ Ð½ÑƒÐ¶Ð½Ð¾ Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ)
Auth::once()

```
---
#### ðŸ”¹ ÐÐ’Ð¢ÐžÐ Ð˜Ð—ÐÐ¦Ð˜Ð¯

ÐÐ²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¾ Ð»Ð¸ Ð²Ð°Ð¼ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ ÐºÐ°ÐºÐ¸Ñ…-Ñ‚Ð¾ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹, Ð² Ð»Ð°Ñ€Ð°Ð²ÐµÐ» ÐµÑÑ‚ÑŒ Ð´Ð²Ð° ÑÐ¿Ð¾ÑÐ¾Ð±Ð° Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ: 
- Ð¾ÑÐ½Ð¾Ð²Ð°Ð½ Ð½Ð° Ð·Ð°Ð¼Ñ‹ÐºÐ°Ð½Ð¸Ð¸ (Gates)
- Ð¾ÑÐ½Ð¾Ð²Ð°Ð½ Ð½Ð° ÐºÐ»Ð°ÑÑÐµ (Policy)
##### ðŸ”¸ GATES

> Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð¤Ð°ÑÐ°Ð´ `Gate`, Ð·Ð°Ñ‡Ð°ÑÑ‚ÑƒÑŽ Ð¿Ñ€Ð¾Ð¿Ð¸ÑÑ‹Ð²Ð°ÑŽÑ‚ Ð² Ð¼ÐµÑ‚Ð¾Ð´Ðµ `boot` (`app/Providers/AuthServiceProvider.php`), Ð´Ð»Ñ Ð¾Ð±ÑŠÑÐ²Ð»ÐµÐ½Ð¸Ñ ÐºÑ€Ð¸Ñ‚ÐµÑ€Ð¸ÐµÐ² Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑŒÑÑ Ð¼ÐµÑ‚Ð¾Ð´ `define`

```php
// Ñ€Ð°Ð·Ñ€ÐµÑˆÐ°ÐµÑ‚ÑŒÑÑ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿Ð¾ÑÑ‚ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ Ñ id = 1
Gate::define('create-post', function ($user) {
    return $user->id == 1;
});

// Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚, Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¾ Ð»Ð¸ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¼Ñƒ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ ÑÐ¾Ð·Ð´Ð°Ð²Ð°Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ð¹ Ð¿Ð¾ÑÑ‚
Gate::allows('create-post');

// Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
Gate::define('edit-post', function ($user, $post) {
    return $user->id == $post->user_id;
});
Gate::allows('edit-post', $post)

// Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ð° Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ñ… Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð², ($user Ð¿ÐµÑ€ÐµÐ´Ð°ÐµÑ‚ÑŒÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸)
Gate::allows('gate-name', [$param1, $param2]);
```

==Ð¼ÐµÑ‚Ð¾Ð´Ñ‹ Ð³ÐµÐ¹Ñ‚Ð¾Ð²==
```php
// Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚, Ð¼Ð¾Ð¶ÐµÑ‚ Ð»Ð¸ Ð±Ñ‹Ñ‚ÑŒ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¾ Ð´Ð°Ð½Ð½Ð¾Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ
Gate::allows(string $ability, $arguments = []): bool

// Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚, Ð·Ð°Ð¿Ñ€ÐµÑ‰ÐµÐ½Ð¾ Ð»Ð¸ Ð´Ð°Ð½Ð½Ð¾Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ
Gate::denies(string $ability, $arguments = []): bool

// Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚, Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ñ‹ Ð»Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ð¸Ð»Ð¸ Ð¼Ð°ÑÑÐ¸Ð² Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹
Gate::check(array|string $abilities, $arguments = []): bool

// Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚, Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¾ Ð»Ð¸ ÐºÐ°ÐºÐ¾Ðµ-Ð»Ð¸Ð±Ð¾ Ð¸Ð· ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ñ‹Ñ… Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹
Gate::any(array|string $abilities, $arguments = []): bool

// Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚, Ð·Ð°Ð¿Ñ€ÐµÑ‰ÐµÐ½Ð¾ Ð»Ð¸ ÐºÐ°ÐºÐ¾Ðµ-Ð»Ð¸Ð±Ð¾ Ð¸Ð· ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ñ‹Ñ… Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹
Gate::none(array|string $abilities, $arguments = []): bool

// Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚, Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¾ Ð»Ð¸ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ. ÐµÑÐ»Ð¸ Ð½ÐµÑ‚, Ñ‚Ð¾ Ð²Ñ‹Ð±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÑ‚ Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Illuminate\Auth\Access\AuthorizationException
Gate::authorize(string $ability, $arguments = []): Response

// ÐµÑÐ»Ð¸ Ð½ÑƒÐ¶Ð½Ð¾ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð½Ðµ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ (Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð¾Ð²Ð°Ð½Ð¾Ð³Ð¾), Ð° Ð´Ñ€ÑƒÐ³Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑŒÑÑ Ð¼ÐµÑ‚Ð¾Ð´ forUser() 
Gate::forUser(User::find(10))->allows('edit-post', Post::find(20));
```

> ==Before Ð¸ After==. Ð•ÑÐ»Ð¸ Ð²Ñ‹ Ð³Ð´Ðµ-Ñ‚Ð¾ ÑÑ‚Ð°Ð»ÐºÐ¸Ð²Ð°ÐµÑ‚ÐµÑÑŒ Ñ ÑÐ¸Ñ‚ÑƒÐ°Ñ†Ð¸ÐµÐ¹, Ñ‡Ñ‚Ð¾ Ð²Ð°Ð¼ Ð½ÑƒÐ¶Ð½Ð¾ Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð´Ð¸Ñ‚ÑŒ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸ÑŽ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð¸Ð»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð±ÑƒÐ´ÐµÑ‚ Ð¸Ð¼ÐµÑ‚ÑŒ Ð¿Ñ€Ð°Ð²Ð° Ð´Ð»Ñ ÑÐ¾Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ, Ñ‚Ð¾ Ð²Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð¼ÐµÑ‚Ð¾Ð´ `before`. Ð’Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÑÑ‚Ð¾Ð»ÑŒÐºÐ¾ ÐºÐ¾Ð»Ð±ÑÐºÐ¾Ð² `before`, ÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð²Ð°Ð¼ Ð½ÑƒÐ¶Ð½Ð¾. ÐÐ¾ ÐµÑÐ»Ð¸ Ñ…Ð¾Ñ‚Ñ Ð±Ñ‹ Ð¾Ð´Ð¸Ð½ Ð¸Ð· Ð½Ð¸Ñ… Ð²ÐµÑ€Ð½Ñ‘Ñ‚ Ð½ÐµÐ½ÑƒÐ»ÐµÐ²Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ, Ñ‚Ð¾ Ð¾Ð½Ð¾ Ð±ÑƒÐ´ÐµÑ‚ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰ÐµÐ½Ð¾ ÐºÐ°Ðº Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð²Ð°ÑˆÐµÐ¹ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ð¾Ð½Ð½Ð¾Ð¹ Ð»Ð¾Ð³Ð¸ÐºÐ¸ Ð¸ Ð¸Ð¼ÐµÐ½Ð½Ñ‹Ðµ Ð“ÐµÐ¹Ñ‚Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒÑÑ Ð´Ð°Ð»ÐµÐµ Ð½Ðµ Ð±ÑƒÐ´ÐµÑ‚. ÐšÑ€Ð¾Ð¼Ðµ Ñ‚Ð¾Ð³Ð¾, Ð²Ñ‹ Ñ‚Ð°ÐºÐ¶Ðµ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ ÐºÐ¾Ð»Ð±ÑÐºÐ¸ `after`. ÐÐ¾ ÐµÑÐ»Ð¸ Ð²Ð°ÑˆÐ° ÐºÐ°ÑÑ‚Ð¾Ð¼Ð½Ð°Ñ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¸Ð»Ð¸ `before` Ð½Ðµ Ð²ÐµÑ€Ð½Ñ‘Ñ‚ Ð½Ð¸ÐºÐ°ÐºÐ¾Ð³Ð¾ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ, Ñ‚Ð¾ `after` ÐµÐ³Ð¾ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿Ð¸ÑˆÐµÑ‚

```php
Gate::before(function ($user, $ability) {
    if ($user->isSuperAdmin()) {
        return true;
    }
});

Gate::after(function ($user, $ability, $result, $arguments) {
    if ($user->isSuperAdmin()) {
        return true;
    }
});

```
---
##### ðŸ”¸ POLICY

> Ð¿Ð¾Ð»Ð¸Ñ‚Ð¸ÐºÐ¸ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð¿Ð¾Ñ…Ð¾Ð¶Ð¸ Ð½Ð° ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð»ÐµÑ€Ñ‹

```bash
# ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿Ð¾Ð»Ð¸Ñ‚Ð¸ÐºÑƒ
php artisan make:policy PostPolicy
```


==Ð¿Ð¾ÑÐ»Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ ÐµÐµ Ð½ÑƒÐ¶Ð½Ð¾ Ð·Ð°Ñ€ÐµÐ³ÐµÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ==
```php
// Ð² AuthServiceProvider Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ

protected $policies = [
    Post::class => PostPolicy::class,
];
```

==ÑˆÐ°Ð±Ð»Ð¾Ð½==
```php
class PostPolicy
{
    use HandlesAuthorization;

    public function create (User $user) {
        return true;
    }
    public function edit (User $user, Post $post) {
        return $user->id == $post->user_id;
    }
    public function update (User $user, Post $post) {
        return $user->id == $post->user_id;
    }
    public function delete (User $user, Post $post) {
        return $user->id == $post->user_id;
} 
```

==Ð¼ÐµÑ‚Ð¾Ð´Ñ‹ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÑŽÑ‚ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ==
```php
// Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°, Ð² Ð´Ð°Ð½Ð½Ð¾Ð¼ ÑÐ»ÑƒÑ‡Ð°Ðµ edit ÑÑÑ‹Ð»Ð°ÐµÑ‚ÑŒÑÑ Ð½Ð° Ð¼ÐµÑ‚Ð¾Ð´
// ÐºÐ»Ð°ÑÑÐ° PostPolicy::edit
Gate::allows('edit', Post::find(20));

// Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¼Ð¸Ð´Ð»ÐµÐ²Ð°Ñ€Ð¾Ð²
Route::get('/edit/{post}', function (Post $post) {
  // Ð´ÐµÐ»Ð°Ð¹ Ñ‡Ñ‚Ð¾ Ñ…Ð¾Ñ‡ÐµÑˆÑŒ
})->middleware('can:update,post');
// update â€” ÑÑ‚Ð¾ ÑƒÐ¼ÐµÐ½Ð¸Ðµ
// post â€” ÑÑ‚Ð¾ Ð¼Ð¾Ð´ÐµÐ»ÑŒ, Ð¸Ð· Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð° Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð°.
// Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð² Ð¼Ð¸Ð´Ð»Ð²Ð°Ñ€Ðµ can, Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð° Ð¸ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ Ð¼ÐµÑ‚Ð¾Ð´Ð° Ð´Ð¾Ð»Ð¶Ð½Ñ‹ ÑÐ¾Ð²Ð¿Ð°Ð´Ð°Ñ‚ÑŒ


// Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ñ€Ð¸ Ð·Ð°Ð¿Ñ€Ð¾ÑÐµ
User::find($id)->can('update', Post::find(20));
User::find($id)->cannot('update', Post::find(20));

```

==Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð² ÑˆÐ°Ð±Ð»Ð¾Ð½Ð°Ñ…==
```html
@can('update', $post)
<!-- ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¾Ð±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ. -->
<!-- $post ÑÑ‚Ð¾ Ð¼Ð¾Ð´ÐµÐ»ÑŒ, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð² PostPolicy::class -->
@endcan
@can('create', \App\Post::class)
<!-- ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¼Ð¾Ð¶ÐµÑ‚ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ. -->
<!-- \App\Post::class Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð² PostPolicy::class -->
@endcan
@cannot('create', \App\Post::class)
<!-- ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ. -->
<!-- \App\Post::class Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð² PostPolicy::class -->
@endcannot

```
---
