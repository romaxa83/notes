#php #laravel #erorr

#### üîπ –°–û–ó–î–ê–ù–ò–ï –°–í–û–ò EXCEPTION

- —Å–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª  `app\Exceptions\MyException.php` (–º–æ–∂–Ω–æ –≥–¥–µ —É–≥–æ–¥–Ω–æ –µ–≥–æ —Å–æ–∑–¥–∞—Ç—å) —Å —Ç–∞–∫–∏–º —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ–º

```php
namespace App\Exceptions;

use Exception;

class MyException extends Exception
{
    //
}
```


> –∏  –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ —ç—Ç–æ –≤—Å–µ, –∫–∏–¥–∞—Ç—å –≤ –Ω—É–∂–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö –∏ –æ—Ç–ª–∞–≤–ª–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é `try/catch`

> –≤  –∫–ª–∞—Å—Å–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–≤–∞ –º–µ—Ç–æ–¥–∞

- `report()` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∑–∞–ø–∏—Å—å –≤ –∂—É—Ä–Ω–∞–ª ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –≤ BugSnag, –Ω–∞ –ø–æ—á—Ç—É, –≤ Slack –∏ —Ç. –¥.

- `render()` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç —Å –æ—à–∏–±–∫–æ–π –∏–ª–∏ –≤–µ—Ä–Ω—É—Ç—å HTTP-–æ—Ç–≤–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Ñ–∞–π–ª Blade ) –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –∏–∑ –∫–ª–∞—Å—Å–∞ Exception
---
#### üîπ –ü–ï–†–ï–û–ü–†–ï–î–ï–õ–ò–¢–¨ –í–´–í–û–î –û–®–ò–ë–û–ö

> —á—Ç–æ–± –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –¥–ª—è API –∏ –ø–æ–ª—É—á–∏—Ç—å JSON –∞ –Ω–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –æ—à–∏–±–∫–æ–π –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ª–∏–±–æ –¥–æ–ø–æ–ª–Ω–∏—Ç—å –ª–æ–≥–∏–∫–æ–π –º–µ—Ç–æ–¥ -`App\Exceptions\Handler@render`

```php
public function render($request, Throwable $exception)
{
    // –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
    if ($this->isApi($request)){
        $message = $exception->getMessage();

		// –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∫–æ–¥ –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if($exception instanceof AuthenticationException){

            return response()->json([
                'success' => false,
                'data' => $exception->getMessage()
            ], ErrorsCode::NOT_AUTH);
        }
    }

    return parent::render($request, $exception);
}

private function isApi($request): bool
{
    return in_array('api', explode('/', $request->path()));
}
```
---
#### üîπ –°–¢–†–ê–ù–ò–¶–´ –û–®–ò–ë–û–ö

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –æ—à–∏–±–∫–∏ `HTTP`,  –Ω–∞–ø—Ä–∏–º–µ—Ä, 500 ‚Äî –ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞–π—Ç–µ blade-—Ñ–∞–π–ª —Å —ç—Ç–∏–º –∫–æ–¥–æ–º –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –≤ –ø–∞–ø–∫–µ `resources/views/errors/500.blade.php` –∏–ª–∏ `403.blade.php` –∏ –æ–Ω–∞ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ —Å–ª—É—á–∞–µ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è —ç—Ç–æ–π –æ—à–∏–±–∫–∏.

---