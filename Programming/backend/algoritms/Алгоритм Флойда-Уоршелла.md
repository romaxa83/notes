#algoritm #python #recipes

**ะะปะณะพัะธัะผ ะคะปะพะนะดะฐ-ะฃะพััะตะปะปะฐ**ยโ ััะพ ะผะพัะฝัะน ะฐะปะณะพัะธัะผ, ะบะพัะพััะน ะฝะฐัะพะดะธั ะบัะฐััะฐะนัะธะต ัะฐัััะพัะฝะธั ะผะตะถะดัย**ะฒัะตะผะธ ะฟะฐัะฐะผะธ**ยะฒะตััะธะฝ ะณัะฐัะฐ ะทะฐ ะพะดะธะฝ ะฟัะพัะพะด.
ะัะปะธ ะะตะนะบัััะฐ ะธัะตั ะฟััั ะพั ะพะดะฝะพะน ัะพัะบะธ ะดะพ ะฒัะตั, ัะพ ะคะปะพะนะด ััะฐะทั ัััะพะธั ะฟะพะปะฝัั ัะฐะฑะปะธัั ัะฐัััะพัะฝะธะน ยซะบะฐะถะดัะน ั ะบะฐะถะดัะผยป.

#### ๐น ะะฐะบ ะพะฝ ัะฐะฑะพัะฐะตั 

ะะปะณะพัะธัะผ ะพัะฝะพะฒะฐะฝ ะฝะฐ ะดะธะฝะฐะผะธัะตัะบะพะผ ะฟัะพะณัะฐะผะผะธัะพะฒะฐะฝะธะธ. ะั ะฟะพััะตะฟะตะฝะฝะพ ะฟะตัะตะฑะธัะฐะตะผ ะฒัะต ะฒะตััะธะฝั ะธ ัะฟัะฐัะธะฒะฐะตะผ: ยซะกัะฐะฝะตั ะปะธ ะฟััั ะพั ๐ด ะดะพ ๐ต ะบะพัะพัะต, ะตัะปะธ ะผั ะฟัะพะนะดะตะผ ัะตัะตะท ะฒะตััะธะฝั ๐พ ?ยป.ย

ะัะปะธ `dist[i][k] + dist[k][j] < dist[i][j]`, ัะพ ะผั ะพะฑะฝะพะฒะปัะตะผ ะทะฝะฐัะตะฝะธะต.

```python
import math


def get_max_vertex(k, V, S):
    m = 0   # ะฝะฐะธะผะตะฝััะตะต ะดะพะฟัััะธะผะพะต ะทะฝะฐัะตะฝะธะต
    v = -1
    for i, w in enumerate(V[k]):
        if i in S:
            continue

        if w[2] == 1:   # ะดะฒะธะถะตะฝะธะต ะฟะพ ัััะตะปะบะต
            if m < w[0]:
                m = w[0]
                v = i
        else:           # ะดะฒะธะถะตะฝะธะต ะฟัะพัะธะฒ ัััะตะปะบะธ
            if m < w[1]:
                m = w[1]
                v = i

    return v


def get_max_flow(T):
    w = [x[0] for x in T]
    return min(*w)


def updateV(V, T, f):
    for t in T:
        if t[1] == -1:  # ััะพ ะธััะพะบ
            continue

        sgn = V[t[2]][t[1]][2]  # ะฝะฐะฟัะฐะฒะปะตะฝะธะต ะดะฒะธะถะตะฝะธั

        # ะผะตะฝัะตะผ ะฒะตัะฐ ะฒ ัะฐะฑะปะธัะต ะดะปั (i,j) ะธ (j,i)
        V[t[1]][t[2]][0] -= f * sgn
        V[t[1]][t[2]][1] += f * sgn

        V[t[2]][t[1]][0] -= f * sgn
        V[t[2]][t[1]][1] += f * sgn


V = [[[0,0,1], [20,0,1], [30,0,1], [10,0,1], [0,0,1]],
     [[20,0,-1], [0,0,1], [40,0,1], [0,0,1], [30,0,1]],
     [[30,0,-1], [40,0,-1], [0,0,1], [10,0,1], [20,0,1]],
     [[10,0,-1], [0,0,1], [10,0,-1], [0,0,1], [20,0,1]],
     [[0,0,1], [30,0,-1], [20,0,-1], [20,0,-1], [0,0,1]],
]

N = len(V)  # ัะธัะปะพ ะฒะตััะธะฝ ะฒ ะณัะฐัะต
init = 0    # ะฒะตััะธะฝะฐ ะธััะพะบะฐ (ะฝัะผะตัะฐัะธั ั ะฝัะปั)
end = 4     # ะฒะตััะธะฝะฐ ััะพะบะฐ
Tinit = (math.inf, -1, init)      # ะฟะตัะฒะฐั ะผะตัะบะฐ ะผะฐัััััะพ (a, from, vertex)
f = []      # ะผะฐะบัะธะผะฐะปัะฝัะต ะฟะพัะพะบะธ ะฝะฐะนะดะตะฝะฝัั ะผะฐัััััะพะฒ

j = init
while j != -1:
    k = init  # ััะฐััะพะฒะฐั ะฒะตััะธะฝะฐ (ะฝัะผะตัะฐัะธั ั ะฝัะปั)
    T = [Tinit]  # ะผะตัะบะธ ะผะฐัััััะฐ
    S = {init}  # ะผะฝะพะถะตััะฒะพ ะฟัะพัะผะพััะตะฝะฝัั ะฒะตััะธะฝ

    while k != end:     # ะฟะพะบะฐ ะฝะต ะดะพัะปะธ ะดะพ ััะพะบะฐ
        j = get_max_vertex(k, V, S)  # ะฒัะฑะธัะฐะตะผ ะฒะตััะธะฝั ั ะฝะฐะธะฑะพะปััะตะน ะฟัะพะฟััะบะฝะพะน ัะฟะพัะพะฑะฝะพัััั
        if j == -1:         # ะตัะปะธ ัะปะตะดัััะธั ะฒะตััะธะฝ ะฝะตั
            if k == init:      # ะธ ะผั ะฝะฐ ะธััะพะบะต, ัะพ
                break          # ะทะฐะฒะตััะฐะตะผ ะฟะพะธัะบ ะผะฐัััััะพะฒ
            else:           # ะธะฝะฐัะต, ะฟะตัะตัะพะดะธะผ ะบ ะฟัะตะดัะดััะตะน ะฒะตััะธะฝะต
                k = T.pop()[2]
                continue

        c = V[k][j][0] if V[k][j][2] == 1 else V[k][j][1]   # ะพะฟัะตะดะตะปัะตะผ ัะตะบััะธะน ะฟะพัะพะบ
        T.append((c, j, k))    # ะดะพะฑะฐะฒะปัะตะผ ะผะตัะบั ะผะฐัััััะฐ
        S.add(j)            # ะทะฐะฟะพะผะธะฝะฐะตะผ ะฒะตััะธะฝั ะบะฐะบ ะฟัะพัะผะพััะตะฝะฝัั

        if j == end:    # ะตัะปะธ ะดะพัะดะธ ะดะพ ััะพะบะฐ
            f.append(get_max_flow(T))     # ะฝะฐัะพะดะธะผ ะผะฐะบัะธะผะฐะปัะฝัั ะฟัะพะฟััะบะฝัั ัะฟะพัะพะฑะฝะพััั ะผะฐัััััะฐ
            updateV(V, T, f[-1])        # ะพะฑะฝะพะฒะปัะตะผ ะฒะตัะฐ ะดัะณ
            break

        k = j

F = sum(f)
print(f"ะะฐะบัะธะผะฐะปัะฝัะน ะฟะพัะพะบ ัะฐะฒะตะฝ: {F}")
```
---
#### ๐น ะกะฒะพะนััะฒะฐ

- **ะกะปะพะถะฝะพััั:** ๐(๐3) ะญัะพ ะผะฝะพะณะพ, ะฟะพััะพะผั ะฐะปะณะพัะธัะผ ะฟะพะดัะพะดะธั ะดะปั ะณัะฐัะพะฒ ะดะพ 400โ500 ะฒะตััะธะฝ.
- **ะััะธัะฐัะตะปัะฝัะต ะฒะตัะฐ:** ะ ะพัะปะธัะธะต ะพั ะะตะนะบัััั, ะคะปะพะนะด **ะดััะถะธั** ั ะพััะธัะฐัะตะปัะฝัะผะธ ัะตะฑัะฐะผะธ.
- **ะััะธัะฐัะตะปัะฝัะต ัะธะบะปั:** ะก ะตะณะพ ะฟะพะผะพััั ะปะตะณะบะพ ะธั ะฝะฐะนัะธ โ ะตัะปะธ ะฟะพัะปะต ะทะฐะฒะตััะตะฝะธั ะฐะปะณะพัะธัะผะฐ ะฝะฐ ะดะธะฐะณะพะฝะฐะปะธ ะผะฐััะธัั (`dist[i][i]`) ะฟะพัะฒะธะปะพัั ะพััะธัะฐัะตะปัะฝะพะต ัะธัะปะพ, ะทะฝะฐัะธั, ะฒ ะณัะฐัะต ะตััั ะพััะธัะฐัะตะปัะฝัะน ัะธะบะป.ย

#### ๐น ะะพะณะดะฐ ะธัะฟะพะปัะทะพะฒะฐัั?ย
- ะะพะณะดะฐ ะณัะฐั ะฝะตะฑะพะปััะพะน, ะฝะพ ะฝัะถะฝะพ ะทะฝะฐัั ัะฐัััะพัะฝะธั ะผะตะถะดั ะฒัะตะผะธ ัะทะปะฐะผะธ.
1. ะะปั ัะฐััะตัะฐ ยซััะฐะฝะทะธัะธะฒะฝะพะณะพ ะทะฐะผัะบะฐะฝะธัยป ะณัะฐัะฐ (ะฟัะพััะพ ัะทะฝะฐัั, ะผะพะถะฝะพ ะปะธ ะธะท ๐ด ะฟะพะฟะฐััั ะฒ ๐ต ).
2. ะะพะณะดะฐ ะปะตะฝั ะฟะธัะฐัั ัะปะพะถะฝัั ะะตะนะบัััั ั ะพัะตัะตะดัะผะธ, ะฐ ะณัะฐั ะบัะพัะตัะฝัะน โ ะคะปะพะนะด ะฟะธัะตััั ะฒ 3 ัะธะบะปะฐ ะทะฐ ะผะธะฝััั. 