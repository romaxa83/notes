#linux #tools

- info - https://www.opennet.ru/docs/RUS/awk/

==awk== - Ð½ÐµÐ±Ð¾Ð»ÑŒÑˆÐ¾Ð¹ ÑÐ·Ñ‹Ðº Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ, Ð¾Ñ€Ð¸ÐµÐ½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð° Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ñ… Ñ„Ð°Ð¹Ð»Ð¾Ð², Ð¿Ð¾ÑÑ‚Ñ€Ð¾ÐµÐ½ Ð½Ð° Ñ€ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ñ‹Ñ… Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸ÑÑ… Ð¸ ÑÑ‚Ñ€ÐµÐ´ÑÑ‚Ð²Ð°Ñ… Ð´Ð»Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ ÑˆÐ°Ð±Ð»Ð¾Ð½Ð¾Ð²

#### ðŸ”¹ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð°

Ð’ Ð½Ð°Ñ‡Ð°Ð»Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð° ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿ÑƒÑ‚ÑŒ Ðº Ð¸Ð½Ñ‚ÐµÑ€Ð¿Ñ€Ð¸Ñ‚Ð°Ñ‚Ð¾Ñ€Ñƒ - `#!/usr/bin/awk -f`.

Ð¡Ñ†ÐµÐ½Ð°Ñ€Ð¸Ð¹ ÑÐ¾ÑÑ‚Ð¾Ð¸Ñ‚ Ð¸Ð· ÐºÐ¾Ð¼Ð°Ð½Ð´ Ñ‚Ð°ÐºÐ¾Ð³Ð¾ Ð²Ð¸Ð´Ð° - `temlate { action }`.		
- template - ÑÑ‚Ð¾ ÑÑ‚Ñ€Ð¾ÐºÐ°(Ð¸Ð»Ð¸ Ñ€ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ð¾Ðµ Ð²Ñ‹Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ), ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð´Ð¾Ð»Ð¶Ð½Ð° Ð±Ñ‹Ñ‚ÑŒ Ð² Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÐ¼Ð¾Ð¼ ÑÑ†ÐµÐ½Ð°Ñ€Ð¸ÐµÐ¼ Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ð¾Ð³Ð¾ Ñ„Ð°Ð¹Ð»Ð°. Ð•ÑÐ»Ð¸ `tempate` -  Ñ€ÐµÐ³.Ð²Ñ‹Ñ€. , Ñ‚Ð¾ Ð¾Ð½ Ð·Ð°ÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ÑÑ Ð² ÑÐ»ÐµÑˆ `/template/`
- action - Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ðµ Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¾ Ðº ÑÑ‚Ñ€Ð¾ÐºÐµ, ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ¼ template.

Ð•ÑÐ»Ð¸ `template` Ð½Ðµ ÑƒÐºÐ°Ð·Ð°Ð½, Ñ‚Ð¾ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¾ ÐºÐ¾ Ð²ÑÐµÐ¼ ÑÑ‚Ñ€Ð¾ÐºÐ°Ð¼ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÐ¼Ð¾Ð³Ð¾ Ñ„Ð°Ð¹Ð»Ð°. ÐžÑÐ¾Ð±Ð¾Ðµ Ð²Ð½Ð¸Ð¼Ð°Ð½Ð¸Ðµ Ð·Ð°ÑÐ»ÑƒÐ¶Ð¸Ð²Ð°ÑŽ template `BEGIN` Ð¸ `END`.
- BEGIN - Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ Ð´Ð¾ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ñ„Ð°Ð¹Ð»Ð°.
- END - Ð¿Ð¾ÑÐ»Ðµ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ Ñ„Ð°Ð¹Ð»Ð°

==Ð¿Ñ€Ð¸Ð¼ÐµÑ€:==
```awk
BEGIN {
	print "start"
}
{
  	print "Ð¾ÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð°"
}
END {
	print "end"
}
```
---
#### ðŸ”¹ ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ
- ÑÑ‚Ñ€Ð¾ÐºÐ¾Ð²Ñ‹Ðµ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð¿ÑƒÑÑ‚Ð¾Ð¹ ÑÑ‚Ñ€Ð¾ÐºÐ¾Ð¹ (name="")
- Ñ‡Ð¸ÑÐ»Ð¾Ð²Ñ‹Ðµ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð½ÑƒÐ»ÐµÐ¼ (counter=0)
---
#### ðŸ”¹ ÐŸÐ Ð˜ÐœÐ•Ð Ð«

```bash
# Ð²Ñ‹Ð²ÐµÐ´ÐµÑ‚ Ñ„Ð°Ð¹Ð»Ñ‹ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ„Ð°Ð¹Ð»Ñ‹ (Ñ‚.Ðµ. Ð²Ñ‹Ð²ÐµÐ´ÐµÑ‚ Ð³Ð´Ðµ Ð² Ð½Ð°Ñ‡Ð°Ð»Ðµ ÑÑ‚Ð¾Ð¸Ñ‚ Ñ‚Ð¸Ñ€Ðµ)
ls -l | awk '/^-/' 
```
---
#### ðŸ”¹ ÐŸÑ€Ð¸Ð¼ÐµÑ€ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð°

```awk
{
	sum+=$5
	if (NR==1){
		min=$5
		max=$5
		min_name=$9
		max_name=$9
	}
	if ($5 > max){
		max=$5
		max_name=$9
	}
	if ($5 < min){
		min=$5
		min_name=$9
	}
}
END{
	print "SUM: ", sum/1024/1024 " MB"
	print "Files: ", NR
	if(stats==1){
		print "Ð¡Ð°Ð¼Ñ‹Ð¹ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ð¹ Ñ„Ð°Ð¹Ð» :\t", max_name, max/1024/1024, "MB"
		print "Ð¡Ð°Ð¼Ñ‹Ð¹ Ð¼Ð°Ð»ÐµÐ½ÑŒÐºÐ¸Ð¹ Ñ„Ð°Ð¹Ð» :\t", min_name, min/1024/1024, "MB"
	}
}
```
---