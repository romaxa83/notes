#linux #ssh

#### üîπ –°–æ–∑–¥–∞–Ω–∏–µ SSH –∫–ª—é—á–µ–π
```bash
# —Å–æ–∑–¥–∞–Ω–∏–µ (–±—É–¥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è ~/.ssh)
ssh-keygen

# —á—Ç–æ–± —É–∫–∞–∑–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–ø–∏—Å–∏
ssh-keygen -t ed25519

# id_rsa.pub - –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á(–µ–≥–æ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–º)
# id_rsa - –ª–∏—á–Ω—ã–π –∫–ª—é—á(–µ–≥–æ –Ω–µ–ª—å–∑—è –Ω–∏–∫–æ–º—É –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å)
```
---
#### üîπ –í–æ–π—Ç–∏ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
```bash
# root - username
ssh root@–Ω–∞–∑–≤–∞–Ω–∏–µ_—Å–∞–π—Ç–∞

# —É–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥ –∫–∞–∫–∏–º –∫–ª—é—á–æ–º –∑–∞—Ö–æ–¥–∏–º
ssh -i "~/.ssh/romaxa-key-frankfurt.pem" ubuntu@3.120.128.1
```
---
#### üîπ –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ SSH
```bash
# –ï—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª —Å —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä —á–µ—Ä–µ–∑ SSH, –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –º–æ–∂–Ω–æ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é scp

# –°–ª–µ–¥—É—é—â–µ–µ –∫–æ–º–∞–Ω–¥–∞ —Å–∫–æ–ø–∏—Ä—É–µ—Ç —Ñ–∞–π–ª foobar.txt —Å —Å–µ—Ä–≤–µ—Ä–∞ –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥
scp username@remotehost.com:/path/to/foobar.txt /some/local/directory

# –ö–æ–º–∞–Ω–¥—É scp –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ –≤ –æ–±—Ä–∞—Ç–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ ‚Äì –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–π –ø–∞–ø–∫–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp /some/local/directory/foobar.txt username@remotehost.com:/destination/path/

# –¢–æ –∂–µ —Å–∞–º–æ–µ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Å –∫–∞—Ç–∞–ª–æ–≥–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É—è –æ–ø—Ü–∏—é -r, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ —Å–∫–æ–ø–∏—Ä—É–µ—Ç –≤—Å–µ –∫–∞—Ç–∞–ª–æ–≥–∏
```
---
#### üîπ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SSH —Å–µ—Ä–≤–µ—Ä
```bash
sudo apt-get install ssh
sudo apt install openssh-server

# —Å–ª—É–∂–±–∞ –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
sudo systemctl enable sshd

# –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É
sudo systemctl disable sshd 

# –∫–æ–Ω—Ñ–∏–≥–∏
cd /etc/ssh

-- @see - https://losst.ru/ustanovka-ssh-ubuntu-16-04
```

> –¢—É—Ç –±–æ–ª—å—à–µ –∏–Ω—Ñ—ã -  https://losst.ru/ustanovka-ssh-ubuntu-16-04

---
#### üîπ –î–∞—Ç—å –¥–æ—Å—Ç—É–ø –Ω–∞ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ SSH
```bash
# –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –∫–æ–ø–∏—Ä—É–µ—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –≤ –∫–æ—Ä–Ω–µ–≤—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –ø–∞–ø–∫—É .ssh, –ø–∞–ø–∫–∏ .shh –∑–∞–¥–∞—é—Ç—å—Å—è –ø—Ä–∞–≤–∞ 'chmod 700 .shh' (—á—Ç–æ–± —Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü –º–æ–≥ —Å –Ω–µ–π —Ä–∞–±–æ—Ç–∞—Ç—å) –∑–∞—Ç–µ–º ,—Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã–π –∫–ª—é—á –∫–æ–ø–∏—Ä—É–µ–º –≤ authorized_keys

cat id_rsa.pub >> .ssh/authorized_keys
chmod 644 .ssh/authorized_keys

# –ø–æ—Å–ª–µ –≤—Ö–æ–¥ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - ssh username@host
```
---
#### üîπ –ü—Ä–æ–∫–∏–Ω—É—Ç—å –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä
```bash
# –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
mkdir ~/.ssh # –µ—Å–ª–∏ –µ–µ –Ω–µ—Ç—É
cd ~/.ssh/
nano authorized_keys # –∑–¥–µ—Å—å —Ö—Ä–∞–Ω—è—Ç—Å—è –≤—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è –≤—Ö–æ–¥–∞ –≤—Å—Ç–∞–≤–ª—è–µ–º –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á

# –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–π –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á ssh
cat ~/.ssh/id_rsa.pub
```
---
#### üîπ –ê–ª–∏–∞—Å –¥–ª—è SSH
```bash
nano ~/.ssh/config

# –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º (–ø—Ä–∏–º–µ—Ä)
Host dev
Hostname 195.201.39.33
User wezom
Port 22

–ø–æ—Å–ª–µ –º–æ–∂–µ–º –∑–∞—Ö–æ–¥–∏—Ç—å
ssh dev
```
---
#### üîπ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –∫–ª—é—á–µ–π
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ SSH –∫–∞—Ç–∞–ª–æ–≥–∞ –∏ –∫–ª—é—á–µ–π
mkdir ~/.ssh
chmod 700 ~/.ssh

# –ü—Ä–∞–≤–∞ –Ω–∞ –∫–ª—é—á–∏
chmod 600 ~/.ssh/id_rsa          # –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á
chmod 644 ~/.ssh/id_rsa.pub      # –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á
chmod 600 ~/.ssh/authorized_keys # —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏
chmod 600 ~/.ssh/config          # –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SSH
```
---
#### üîπ –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

###### üî∏ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∞ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–π —Ö–æ—Å—Ç —á–µ—Ä–µ–∑ SSH
```bash
# –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
rsync -avz -e ssh /local/dir/ user@remote:/remote/dir/
```
-a ‚Äî –∞—Ä—Ö–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –∞—Ç—Ä–∏–±—É—Ç—ã —Ñ–∞–π–ª–æ–≤; 
-v ‚Äî –ø–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ –ø—Ä–æ—Ü–µ—Å—Å–∞;
-z ‚Äî —Å–∂–∞—Ç–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–µ—Ç–∏ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–µ—Ä–µ–¥–∞—á–∏;
-e ssh ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ssh –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

–ß—Ç–æ–±—ã –Ω–µ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–∏—á–µ–≥–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, –∞ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–æ, –¥–æ–±–∞–≤—å—Ç–µ --dry-run.

–§–ª–∞–≥ --delete —É–¥–∞–ª–∏—Ç –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ —Å—Ç–æ–∏—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—ã —É–≤–µ—Ä–µ–Ω—ã.

---
